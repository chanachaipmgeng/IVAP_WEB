<!doctype html>
<html class="no-js" lang="">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="x-ua-compatible" content="ie=edge">
        <title>frontend documentation</title>
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <link rel="icon" type="image/x-icon" href="../images/favicon.ico">
	   <link rel="stylesheet" href="../styles/style.css">
        <link rel="stylesheet" href="../styles/dark.css">
    </head>
    <body>
          <script>
               // Blocking script to avoid flickering dark mode
               // Dark mode toggle button
               var useDark = window.matchMedia('(prefers-color-scheme: dark)');
               var darkModeState = useDark.matches;
               var $darkModeToggleSwitchers = document.querySelectorAll('.dark-mode-switch input');
               var $darkModeToggles = document.querySelectorAll('.dark-mode-switch');
               var darkModeStateLocal = localStorage.getItem('compodoc_darkmode-state');

               function checkToggle(check) {
                    for (var i = 0; i < $darkModeToggleSwitchers.length; i++) {
                         $darkModeToggleSwitchers[i].checked = check;
                    }
               }

               function toggleDarkMode(state) {
                    if (window.localStorage) {
                         localStorage.setItem('compodoc_darkmode-state', state);
                    }

                    checkToggle(state);

                    const hasClass = document.body.classList.contains('dark');

                    if (state) {
                         for (var i = 0; i < $darkModeToggles.length; i++) {
                              $darkModeToggles[i].classList.add('dark');
                         }
                         if (!hasClass) {
                              document.body.classList.add('dark');
                         }
                    } else {
                         for (var i = 0; i < $darkModeToggles.length; i++) {
                              $darkModeToggles[i].classList.remove('dark');
                         }
                         if (hasClass) {
                              document.body.classList.remove('dark');
                         }
                    }
               }

               useDark.addEventListener('change', function (evt) {
                    toggleDarkMode(evt.matches);
               });
               if (darkModeStateLocal) {
                    darkModeState = darkModeStateLocal === 'true';
               }
               toggleDarkMode(darkModeState);
          </script>
          <script>
              // --- Iframe navigation tracking for Template Playground ---
              function sendCurrentUrlToParent() {
                  if (window.parent && window.parent !== window) {
                      window.parent.postMessage({
                          type: 'compodoc-iframe-navigate',
                          url: window.location.pathname + window.location.hash
                      }, '*');
                  }
              }
              window.addEventListener('hashchange', sendCurrentUrlToParent, false);
              window.addEventListener('popstate', sendCurrentUrlToParent, false);
              window.addEventListener('DOMContentLoaded', sendCurrentUrlToParent, false);
          </script>

        <div class="navbar navbar-default navbar-fixed-top d-md-none p-0">
               <div class="d-flex">
                    <a href="../" class="navbar-brand">frontend documentation</a>
                    <button type="button" class="btn btn-default btn-menu ion-ios-menu" id="btn-menu"></button>
               </div>
        </div>

        <div class="xs-menu menu" id="mobile-menu">
                <div id="book-search-input" role="search"><input type="text" placeholder="Type to search"></div>            <compodoc-menu></compodoc-menu>
        </div>

        <div class="container-fluid main">
           <div class="row main">
               <div class="d-none d-md-block menu">
                   <compodoc-menu mode="normal"></compodoc-menu>
               </div>
               <!-- START CONTENT -->
               <div class="content interface">
                   <div class="content-data">

















<ol class="breadcrumb">
  <li class="breadcrumb-item">Interfaces</li>
  <li class="breadcrumb-item"
  >
  MultiTenantConfig</li>
</ol>

<ul class="nav nav-tabs" role="tablist">
        <li class="nav-item">
            <a href="#info" 
                class="nav-link"
                class="nav-link active"
                role="tab" id="info-tab" data-bs-toggle="tab" data-link="info">Info</a>
        </li>
        <li class="nav-item">
            <a href="#source" 
                class="nav-link"
                
                role="tab" id="source-tab" data-bs-toggle="tab" data-link="source">Source</a>
        </li>
</ul>

<div class="tab-content">
    <div class="tab-pane fade active in" id="info">
        <p class="comment">
            <h3>File</h3>
        </p>
        <p class="comment">
            <code>src/app/core/services/multi-tenant.service.ts</code>
        </p>




        <section data-compodoc="block-index">
            <h3 id="index">Index</h3>
            <table class="table table-sm table-bordered index-table">
                <tbody>
                    <tr>
                        <td class="col-md-4">
                            <h6><b>Properties</b></h6>
                        </td>
                    </tr>
                    <tr>
                        <td class="col-md-4">
                            <ul class="index-list">
                                <li>
                                        <a href="#allowCustomDomains" 
>
                                            allowCustomDomains
                                        </a>
                                </li>
                                <li>
                                        <a href="#allowSubdomains" 
>
                                            allowSubdomains
                                        </a>
                                </li>
                                <li>
                                        <a href="#auditLogging" 
>
                                            auditLogging
                                        </a>
                                </li>
                                <li>
                                        <a href="#autoProvisioning" 
>
                                            autoProvisioning
                                        </a>
                                </li>
                                <li>
                                        <a href="#billingEnabled" 
>
                                            billingEnabled
                                        </a>
                                </li>
                                <li>
                                        <a href="#dataIsolation" 
>
                                            dataIsolation
                                        </a>
                                </li>
                                <li>
                                        <a href="#defaultPlan" 
>
                                            defaultPlan
                                        </a>
                                </li>
                                <li>
                                        <a href="#enabled" 
>
                                            enabled
                                        </a>
                                </li>
                                <li>
                                        <a href="#maxTenantsPerUser" 
>
                                            maxTenantsPerUser
                                        </a>
                                </li>
                                <li>
                                        <a href="#usageTracking" 
>
                                            usageTracking
                                        </a>
                                </li>
                            </ul>
                        </td>
                    </tr>
                </tbody>
            </table>
        </section>



            <section data-compodoc="block-properties">
                <h3 id="inputs">Properties</h3>
                    <table class="table table-sm table-bordered">
                        <tbody>
                                <tr>
                                    <td class="col-md-4">
                                        <a name="allowCustomDomains"></a>
                                        <span class="name "><b>allowCustomDomains</b>
                                            <a href="#allowCustomDomains">
                                                <span class="icon ion-ios-link"></span>
                                            </a>
                                        </span>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="col-md-4">
                                        <code>allowCustomDomains:         <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/boolean" target="_blank" >boolean</a></code>
</code>
                                    </td>
                                </tr>


                                    <tr>
                                        <td class="col-md-4">
                                            <i>Type : </i>        <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/boolean" target="_blank" >boolean</a></code>

                                        </td>
                                    </tr>





                        </tbody>
                    </table>
                    <table class="table table-sm table-bordered">
                        <tbody>
                                <tr>
                                    <td class="col-md-4">
                                        <a name="allowSubdomains"></a>
                                        <span class="name "><b>allowSubdomains</b>
                                            <a href="#allowSubdomains">
                                                <span class="icon ion-ios-link"></span>
                                            </a>
                                        </span>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="col-md-4">
                                        <code>allowSubdomains:         <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/boolean" target="_blank" >boolean</a></code>
</code>
                                    </td>
                                </tr>


                                    <tr>
                                        <td class="col-md-4">
                                            <i>Type : </i>        <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/boolean" target="_blank" >boolean</a></code>

                                        </td>
                                    </tr>





                        </tbody>
                    </table>
                    <table class="table table-sm table-bordered">
                        <tbody>
                                <tr>
                                    <td class="col-md-4">
                                        <a name="auditLogging"></a>
                                        <span class="name "><b>auditLogging</b>
                                            <a href="#auditLogging">
                                                <span class="icon ion-ios-link"></span>
                                            </a>
                                        </span>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="col-md-4">
                                        <code>auditLogging:         <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/boolean" target="_blank" >boolean</a></code>
</code>
                                    </td>
                                </tr>


                                    <tr>
                                        <td class="col-md-4">
                                            <i>Type : </i>        <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/boolean" target="_blank" >boolean</a></code>

                                        </td>
                                    </tr>





                        </tbody>
                    </table>
                    <table class="table table-sm table-bordered">
                        <tbody>
                                <tr>
                                    <td class="col-md-4">
                                        <a name="autoProvisioning"></a>
                                        <span class="name "><b>autoProvisioning</b>
                                            <a href="#autoProvisioning">
                                                <span class="icon ion-ios-link"></span>
                                            </a>
                                        </span>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="col-md-4">
                                        <code>autoProvisioning:         <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/boolean" target="_blank" >boolean</a></code>
</code>
                                    </td>
                                </tr>


                                    <tr>
                                        <td class="col-md-4">
                                            <i>Type : </i>        <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/boolean" target="_blank" >boolean</a></code>

                                        </td>
                                    </tr>





                        </tbody>
                    </table>
                    <table class="table table-sm table-bordered">
                        <tbody>
                                <tr>
                                    <td class="col-md-4">
                                        <a name="billingEnabled"></a>
                                        <span class="name "><b>billingEnabled</b>
                                            <a href="#billingEnabled">
                                                <span class="icon ion-ios-link"></span>
                                            </a>
                                        </span>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="col-md-4">
                                        <code>billingEnabled:         <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/boolean" target="_blank" >boolean</a></code>
</code>
                                    </td>
                                </tr>


                                    <tr>
                                        <td class="col-md-4">
                                            <i>Type : </i>        <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/boolean" target="_blank" >boolean</a></code>

                                        </td>
                                    </tr>





                        </tbody>
                    </table>
                    <table class="table table-sm table-bordered">
                        <tbody>
                                <tr>
                                    <td class="col-md-4">
                                        <a name="dataIsolation"></a>
                                        <span class="name "><b>dataIsolation</b>
                                            <a href="#dataIsolation">
                                                <span class="icon ion-ios-link"></span>
                                            </a>
                                        </span>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="col-md-4">
                                        <code>dataIsolation:     <code>&quot;shared&quot; | &quot;separate&quot; | &quot;hybrid&quot;</code>
</code>
                                    </td>
                                </tr>


                                    <tr>
                                        <td class="col-md-4">
                                            <i>Type : </i>    <code>&quot;shared&quot; | &quot;separate&quot; | &quot;hybrid&quot;</code>

                                        </td>
                                    </tr>





                        </tbody>
                    </table>
                    <table class="table table-sm table-bordered">
                        <tbody>
                                <tr>
                                    <td class="col-md-4">
                                        <a name="defaultPlan"></a>
                                        <span class="name "><b>defaultPlan</b>
                                            <a href="#defaultPlan">
                                                <span class="icon ion-ios-link"></span>
                                            </a>
                                        </span>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="col-md-4">
                                        <code>defaultPlan:     <code>&quot;basic&quot; | &quot;standard&quot; | &quot;premium&quot; | &quot;enterprise&quot;</code>
</code>
                                    </td>
                                </tr>


                                    <tr>
                                        <td class="col-md-4">
                                            <i>Type : </i>    <code>&quot;basic&quot; | &quot;standard&quot; | &quot;premium&quot; | &quot;enterprise&quot;</code>

                                        </td>
                                    </tr>





                        </tbody>
                    </table>
                    <table class="table table-sm table-bordered">
                        <tbody>
                                <tr>
                                    <td class="col-md-4">
                                        <a name="enabled"></a>
                                        <span class="name "><b>enabled</b>
                                            <a href="#enabled">
                                                <span class="icon ion-ios-link"></span>
                                            </a>
                                        </span>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="col-md-4">
                                        <code>enabled:         <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/boolean" target="_blank" >boolean</a></code>
</code>
                                    </td>
                                </tr>


                                    <tr>
                                        <td class="col-md-4">
                                            <i>Type : </i>        <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/boolean" target="_blank" >boolean</a></code>

                                        </td>
                                    </tr>





                        </tbody>
                    </table>
                    <table class="table table-sm table-bordered">
                        <tbody>
                                <tr>
                                    <td class="col-md-4">
                                        <a name="maxTenantsPerUser"></a>
                                        <span class="name "><b>maxTenantsPerUser</b>
                                            <a href="#maxTenantsPerUser">
                                                <span class="icon ion-ios-link"></span>
                                            </a>
                                        </span>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="col-md-4">
                                        <code>maxTenantsPerUser:         <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/number" target="_blank" >number</a></code>
</code>
                                    </td>
                                </tr>


                                    <tr>
                                        <td class="col-md-4">
                                            <i>Type : </i>        <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/number" target="_blank" >number</a></code>

                                        </td>
                                    </tr>





                        </tbody>
                    </table>
                    <table class="table table-sm table-bordered">
                        <tbody>
                                <tr>
                                    <td class="col-md-4">
                                        <a name="usageTracking"></a>
                                        <span class="name "><b>usageTracking</b>
                                            <a href="#usageTracking">
                                                <span class="icon ion-ios-link"></span>
                                            </a>
                                        </span>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="col-md-4">
                                        <code>usageTracking:         <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/boolean" target="_blank" >boolean</a></code>
</code>
                                    </td>
                                </tr>


                                    <tr>
                                        <td class="col-md-4">
                                            <i>Type : </i>        <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/boolean" target="_blank" >boolean</a></code>

                                        </td>
                                    </tr>





                        </tbody>
                    </table>
            </section>
    </div>


    <div class="tab-pane fade  tab-source-code" id="source">
        <pre class="line-numbers compodoc-sourcecode"><code class="language-typescript">import { Injectable, signal, computed } from &#x27;@angular/core&#x27;;
import { Observable } from &#x27;rxjs&#x27;;

export interface Tenant {
  id: string;
  name: string;
  domain: string;
  subdomain: string;
  status: &#x27;active&#x27; | &#x27;inactive&#x27; | &#x27;suspended&#x27; | &#x27;pending&#x27;;
  plan: &#x27;basic&#x27; | &#x27;standard&#x27; | &#x27;premium&#x27; | &#x27;enterprise&#x27;;
  features: {
    [key: string]: boolean;
  };
  limits: {
    maxUsers: number;
    maxDevices: number;
    maxStorage: number; // in GB
    maxApiCalls: number;
    maxReports: number;
  };
  usage: {
    users: number;
    devices: number;
    storage: number; // in GB
    apiCalls: number;
    reports: number;
  };
  settings: {
    [key: string]: any;
  };
  billing: {
    cycle: &#x27;monthly&#x27; | &#x27;yearly&#x27;;
    amount: number;
    currency: string;
    nextBilling: Date;
    status: &#x27;active&#x27; | &#x27;past_due&#x27; | &#x27;canceled&#x27;;
  };
  createdAt: Date;
  updatedAt: Date;
  createdBy: string;
}

export interface TenantUser {
  id: string;
  tenantId: string;
  userId: string;
  email: string;
  role: &#x27;owner&#x27; | &#x27;admin&#x27; | &#x27;manager&#x27; | &#x27;user&#x27; | &#x27;viewer&#x27;;
  permissions: {
    [key: string]: boolean;
  };
  status: &#x27;active&#x27; | &#x27;inactive&#x27; | &#x27;pending&#x27;;
  lastLogin?: Date;
  createdAt: Date;
  updatedAt: Date;
}

export interface TenantConfig {
  id: string;
  tenantId: string;
  key: string;
  value: any;
  type: &#x27;string&#x27; | &#x27;number&#x27; | &#x27;boolean&#x27; | &#x27;object&#x27; | &#x27;array&#x27;;
  description?: string;
  isSecret: boolean;
  createdAt: Date;
  updatedAt: Date;
}

export interface TenantStats {
  totalTenants: number;
  activeTenants: number;
  inactiveTenants: number;
  suspendedTenants: number;
  tenantsByPlan: { [key: string]: number };
  totalUsers: number;
  totalDevices: number;
  totalStorage: number;
  totalApiCalls: number;
  totalRevenue: number;
  averageUsage: number;
  lastActivity: Date | null;
}

export interface MultiTenantConfig {
  enabled: boolean;
  defaultPlan: &#x27;basic&#x27; | &#x27;standard&#x27; | &#x27;premium&#x27; | &#x27;enterprise&#x27;;
  allowSubdomains: boolean;
  allowCustomDomains: boolean;
  maxTenantsPerUser: number;
  autoProvisioning: boolean;
  dataIsolation: &#x27;shared&#x27; | &#x27;separate&#x27; | &#x27;hybrid&#x27;;
  billingEnabled: boolean;
  usageTracking: boolean;
  auditLogging: boolean;
}

@Injectable({
  providedIn: &#x27;root&#x27;
})
export class MultiTenantService {
  private tenantsMap: Map&lt;string, Tenant&gt; &#x3D; new Map();
  private tenantUsersMap: Map&lt;string, TenantUser&gt; &#x3D; new Map();
  private tenantConfigsMap: Map&lt;string, TenantConfig&gt; &#x3D; new Map();
  private configData: MultiTenantConfig &#x3D; this.getDefaultConfig();
  private _currentTenant &#x3D; signal&lt;Tenant | null&gt;(null);

  // ✅ Signals for reactive state
  private _tenants &#x3D; signal&lt;Tenant[]&gt;([]);
  private _tenantUsers &#x3D; signal&lt;TenantUser[]&gt;([]);
  private _tenantConfigs &#x3D; signal&lt;TenantConfig[]&gt;([]);
  private _stats &#x3D; signal&lt;TenantStats&gt;(this.getInitialStats());
  private _config &#x3D; signal&lt;MultiTenantConfig&gt;(this.configData);

  // ✅ Readonly signals for public access
  public readonly tenants &#x3D; this._tenants.asReadonly();
  public readonly tenantUsers &#x3D; this._tenantUsers.asReadonly();
  public readonly tenantConfigs &#x3D; this._tenantConfigs.asReadonly();
  public readonly stats &#x3D; this._stats.asReadonly();
  public readonly config &#x3D; this._config.asReadonly();
  public readonly currentTenant &#x3D; this._currentTenant.asReadonly();

  // ✅ Computed signals for derived state
  public readonly tenantsCount &#x3D; computed(() &#x3D;&gt; this._tenants().length);
  public readonly activeTenantsCount &#x3D; computed(() &#x3D;&gt; this._tenants().filter(t &#x3D;&gt; t.status &#x3D;&#x3D;&#x3D; &#x27;active&#x27;).length);
  public readonly tenantUsersCount &#x3D; computed(() &#x3D;&gt; this._tenantUsers().length);

  constructor() {
    this.initializeService();
  }

  /**
   * Initialize service
   */
  private initializeService(): void {
    this.loadConfig();
    this.loadTenants();
    this.loadTenantUsers();
    this.loadTenantConfigs();
    this.detectCurrentTenant();
  }

  /**
   * Get default configuration
   */
  private getDefaultConfig(): MultiTenantConfig {
    return {
      enabled: true,
      defaultPlan: &#x27;basic&#x27;,
      allowSubdomains: true,
      allowCustomDomains: false,
      maxTenantsPerUser: 5,
      autoProvisioning: false,
      dataIsolation: &#x27;separate&#x27;,
      billingEnabled: true,
      usageTracking: true,
      auditLogging: true
    };
  }

  /**
   * Get initial stats
   */
  private getInitialStats(): TenantStats {
    return {
      totalTenants: 0,
      activeTenants: 0,
      inactiveTenants: 0,
      suspendedTenants: 0,
      tenantsByPlan: {},
      totalUsers: 0,
      totalDevices: 0,
      totalStorage: 0,
      totalApiCalls: 0,
      totalRevenue: 0,
      averageUsage: 0,
      lastActivity: null
    };
  }

  /**
   * Load configuration
   */
  private loadConfig(): void {
    try {
      const stored &#x3D; localStorage.getItem(&#x27;multi_tenant_config&#x27;);
      if (stored) {
        this.configData &#x3D; { ...this.configData, ...JSON.parse(stored) };
        this._config.set(this.configData);
      }
    } catch (error) {
      console.error(&#x27;Failed to load multi-tenant config:&#x27;, error);
    }
  }

  /**
   * Save configuration
   */
  private saveConfig(): void {
    try {
      localStorage.setItem(&#x27;multi_tenant_config&#x27;, JSON.stringify(this.configData));
    } catch (error) {
      console.error(&#x27;Failed to save multi-tenant config:&#x27;, error);
    }
  }

  /**
   * Load tenants
   */
  private loadTenants(): void {
    try {
      const stored &#x3D; localStorage.getItem(&#x27;multi_tenant_tenants&#x27;);
      if (stored) {
        const tenants &#x3D; JSON.parse(stored);
        tenants.forEach((tenant: any) &#x3D;&gt; {
          tenant.createdAt &#x3D; new Date(tenant.createdAt);
          tenant.updatedAt &#x3D; new Date(tenant.updatedAt);
          tenant.billing.nextBilling &#x3D; new Date(tenant.billing.nextBilling);
          this.tenantsMap.set(tenant.id, tenant);
        });
        this._tenants.set(Array.from(this.tenantsMap.values()));
      }
    } catch (error) {
      console.error(&#x27;Failed to load tenants:&#x27;, error);
    }
  }

  /**
   * Save tenants
   */
  private saveTenants(): void {
    try {
      const tenants &#x3D; Array.from(this.tenantsMap.values());
      localStorage.setItem(&#x27;multi_tenant_tenants&#x27;, JSON.stringify(tenants));
    } catch (error) {
      console.error(&#x27;Failed to save tenants:&#x27;, error);
    }
  }

  /**
   * Load tenant users
   */
  private loadTenantUsers(): void {
    try {
      const stored &#x3D; localStorage.getItem(&#x27;multi_tenant_users&#x27;);
      if (stored) {
        const users &#x3D; JSON.parse(stored);
        users.forEach((user: any) &#x3D;&gt; {
          user.createdAt &#x3D; new Date(user.createdAt);
          user.updatedAt &#x3D; new Date(user.updatedAt);
          user.lastLogin &#x3D; user.lastLogin ? new Date(user.lastLogin) : undefined;
          this.tenantUsersMap.set(user.id, user);
        });
        this._tenantUsers.set(Array.from(this.tenantUsersMap.values()));
      }
    } catch (error) {
      console.error(&#x27;Failed to load tenant users:&#x27;, error);
    }
  }

  /**
   * Save tenant users
   */
  private saveTenantUsers(): void {
    try {
      const users &#x3D; Array.from(this.tenantUsersMap.values());
      localStorage.setItem(&#x27;multi_tenant_users&#x27;, JSON.stringify(users));
    } catch (error) {
      console.error(&#x27;Failed to save tenant users:&#x27;, error);
    }
  }

  /**
   * Load tenant configs
   */
  private loadTenantConfigs(): void {
    try {
      const stored &#x3D; localStorage.getItem(&#x27;multi_tenant_configs&#x27;);
      if (stored) {
        const configs &#x3D; JSON.parse(stored);
        configs.forEach((config: any) &#x3D;&gt; {
          config.createdAt &#x3D; new Date(config.createdAt);
          config.updatedAt &#x3D; new Date(config.updatedAt);
          this.tenantConfigsMap.set(config.id, config);
        });
        this._tenantConfigs.set(Array.from(this.tenantConfigsMap.values()));
      }
    } catch (error) {
      console.error(&#x27;Failed to load tenant configs:&#x27;, error);
    }
  }

  /**
   * Save tenant configs
   */
  private saveTenantConfigs(): void {
    try {
      const configs &#x3D; Array.from(this.tenantConfigsMap.values());
      localStorage.setItem(&#x27;multi_tenant_configs&#x27;, JSON.stringify(configs));
    } catch (error) {
      console.error(&#x27;Failed to save tenant configs:&#x27;, error);
    }
  }

  /**
   * Detect current tenant
   */
  private detectCurrentTenant(): void {
    const hostname &#x3D; window.location.hostname;
    const subdomain &#x3D; hostname.split(&#x27;.&#x27;)[0];

    if (subdomain &amp;&amp; subdomain !&#x3D;&#x3D; &#x27;www&#x27; &amp;&amp; subdomain !&#x3D;&#x3D; &#x27;localhost&#x27;) {
      const tenant &#x3D; Array.from(this.tenantsMap.values())
        .find(t &#x3D;&gt; t.subdomain &#x3D;&#x3D;&#x3D; subdomain);

      if (tenant) {
        this.setCurrentTenant(tenant);
      }
    }
  }

  /**
   * Create tenant
   */
  public createTenant(tenant: Omit&lt;Tenant, &#x27;id&#x27; | &#x27;createdAt&#x27; | &#x27;updatedAt&#x27; | &#x27;usage&#x27; | &#x27;billing&#x27;&gt;): string {
    const id &#x3D; this.generateId();
    const newTenant: Tenant &#x3D; {
      ...tenant,
      id,
      createdAt: new Date(),
      updatedAt: new Date(),
      usage: {
        users: 0,
        devices: 0,
        storage: 0,
        apiCalls: 0,
        reports: 0
      },
      billing: {
        cycle: &#x27;monthly&#x27;,
        amount: this.getPlanAmount(tenant.plan),
        currency: &#x27;USD&#x27;,
        nextBilling: new Date(Date.now() + 30 * 24 * 60 * 60 * 1000),
        status: &#x27;active&#x27;
      }
    };

    this.tenantsMap.set(id, newTenant);
    this._tenants.set(Array.from(this.tenantsMap.values()));
    this.saveTenants();
    this.updateStats();
    return id;
  }

  /**
   * Get plan amount
   */
  private getPlanAmount(plan: string): number {
    const amounts &#x3D; {
      basic: 29,
      standard: 79,
      premium: 199,
      enterprise: 499
    };
    return amounts[plan as keyof typeof amounts] || 29;
  }

  /**
   * Update tenant
   */
  public updateTenant(id: string, updates: Partial&lt;Tenant&gt;): void {
    const tenant &#x3D; this.tenantsMap.get(id);
    if (tenant) {
      const updatedTenant &#x3D; { ...tenant, ...updates, updatedAt: new Date() };
      this.tenantsMap.set(id, updatedTenant);
      this._tenants.set(Array.from(this.tenantsMap.values()));
      this.saveTenants();
      this.updateStats();
    }
  }

  /**
   * Delete tenant
   */
  public deleteTenant(id: string): void {
    this.tenantsMap.delete(id);
    this._tenants.set(Array.from(this.tenantsMap.values()));
    this.saveTenants();
    this.updateStats();
  }

  /**
   * Set current tenant
   */
  public setCurrentTenant(tenant: Tenant): void {
    this._currentTenant.set(tenant);
  }

  /**
   * Get current tenant
   */
  public getCurrentTenant(): Tenant | null {
    return this._currentTenant();
  }

  /**
   * Switch tenant
   */
  public switchTenant(tenantId: string): boolean {
    const tenant &#x3D; this._tenants().find(t &#x3D;&gt; t.id &#x3D;&#x3D;&#x3D; tenantId);
    if (tenant) {
      this.setCurrentTenant(tenant);
      return true;
    }
    return false;
  }

  /**
   * Add tenant user
   */
  public addTenantUser(user: Omit&lt;TenantUser, &#x27;id&#x27; | &#x27;createdAt&#x27; | &#x27;updatedAt&#x27;&gt;): string {
    const id &#x3D; this.generateId();
    const newUser: TenantUser &#x3D; {
      ...user,
      id,
      createdAt: new Date(),
      updatedAt: new Date()
    };

    this.tenantUsersMap.set(id, newUser);
    this._tenantUsers.set(Array.from(this.tenantUsersMap.values()));
    this.saveTenantUsers();
    this.updateStats();
    return id;
  }

  /**
   * Update tenant user
   */
  public updateTenantUser(id: string, updates: Partial&lt;TenantUser&gt;): void {
    const user &#x3D; this.tenantUsersMap.get(id);
    if (user) {
      const updatedUser &#x3D; { ...user, ...updates, updatedAt: new Date() };
      this.tenantUsersMap.set(id, updatedUser);
      this._tenantUsers.set(Array.from(this.tenantUsersMap.values()));
      this.saveTenantUsers();
    }
  }

  /**
   * Remove tenant user
   */
  public removeTenantUser(id: string): void {
    this.tenantUsersMap.delete(id);
    this._tenantUsers.set(Array.from(this.tenantUsersMap.values()));
    this.saveTenantUsers();
    this.updateStats();
  }

  /**
   * Get users by tenant
   */
  public getUsersByTenant(tenantId: string): TenantUser[] {
    return Array.from(this.tenantUsersMap.values())
      .filter(user &#x3D;&gt; user.tenantId &#x3D;&#x3D;&#x3D; tenantId)
      .sort((a, b) &#x3D;&gt; b.createdAt.getTime() - a.createdAt.getTime());
  }

  /**
   * Set tenant config
   */
  public setTenantConfig(tenantId: string, key: string, value: any, type: string, description?: string, isSecret: boolean &#x3D; false): string {
    const id &#x3D; this.generateId();
    const config: TenantConfig &#x3D; {
      id,
      tenantId,
      key,
      value,
      type: type as any,
      description,
      isSecret,
      createdAt: new Date(),
      updatedAt: new Date()
    };

    this.tenantConfigsMap.set(id, config);
    this._tenantConfigs.set(Array.from(this.tenantConfigsMap.values()));
    this.saveTenantConfigs();
    return id;
  }

  /**
   * Get tenant config
   */
  public getTenantConfig(tenantId: string, key: string): any {
    const config &#x3D; Array.from(this.tenantConfigsMap.values())
      .find(c &#x3D;&gt; c.tenantId &#x3D;&#x3D;&#x3D; tenantId &amp;&amp; c.key &#x3D;&#x3D;&#x3D; key);
    return config ? config.value : null;
  }

  /**
   * Get all tenant configs
   */
  public getTenantConfigs(tenantId: string): TenantConfig[] {
    return Array.from(this.tenantConfigsMap.values())
      .filter(c &#x3D;&gt; c.tenantId &#x3D;&#x3D;&#x3D; tenantId)
      .sort((a, b) &#x3D;&gt; a.key.localeCompare(b.key));
  }

  /**
   * Update tenant config
   */
  public updateTenantConfig(id: string, updates: Partial&lt;TenantConfig&gt;): void {
    const config &#x3D; this.tenantConfigsMap.get(id);
    if (config) {
      const updatedConfig &#x3D; { ...config, ...updates, updatedAt: new Date() };
      this.tenantConfigsMap.set(id, updatedConfig);
      this._tenantConfigs.set(Array.from(this.tenantConfigsMap.values()));
      this.saveTenantConfigs();
    }
  }

  /**
   * Delete tenant config
   */
  public deleteTenantConfig(id: string): void {
    this.tenantConfigsMap.delete(id);
    this._tenantConfigs.set(Array.from(this.tenantConfigsMap.values()));
    this.saveTenantConfigs();
  }

  /**
   * Update tenant usage
   */
  public updateTenantUsage(tenantId: string, usage: Partial&lt;Tenant[&#x27;usage&#x27;]&gt;): void {
    this._tenants.update(tenants &#x3D;&gt; {
      const tenant &#x3D; tenants.find(t &#x3D;&gt; t.id &#x3D;&#x3D;&#x3D; tenantId);
      if (tenant) {
        tenant.usage &#x3D; { ...tenant.usage, ...usage };
        tenant.updatedAt &#x3D; new Date();
      }
      return [...tenants];
    });
    this.updateStats();
  }

  /**
   * Check tenant limits
   */
  public checkTenantLimits(tenantId: string): { [key: string]: { current: number; limit: number; exceeded: boolean } } {
    const tenant &#x3D; this._tenants().find(t &#x3D;&gt; t.id &#x3D;&#x3D;&#x3D; tenantId);
    if (!tenant) return {};

    const limits &#x3D; tenant.limits;
    const usage &#x3D; tenant.usage;

    return {
      users: {
        current: usage.users,
        limit: limits.maxUsers,
        exceeded: usage.users &gt;&#x3D; limits.maxUsers
      },
      devices: {
        current: usage.devices,
        limit: limits.maxDevices,
        exceeded: usage.devices &gt;&#x3D; limits.maxDevices
      },
      storage: {
        current: usage.storage,
        limit: limits.maxStorage,
        exceeded: usage.storage &gt;&#x3D; limits.maxStorage
      },
      apiCalls: {
        current: usage.apiCalls,
        limit: limits.maxApiCalls,
        exceeded: usage.apiCalls &gt;&#x3D; limits.maxApiCalls
      },
      reports: {
        current: usage.reports,
        limit: limits.maxReports,
        exceeded: usage.reports &gt;&#x3D; limits.maxReports
      }
    };
  }

  /**
   * Update configuration
   */
  public updateConfig(updates: Partial&lt;MultiTenantConfig&gt;): void {
    this.configData &#x3D; { ...this.configData, ...updates };
    this._config.set(this.configData);
    this.saveConfig();
  }

  /**
   * Update statistics
   */
  private updateStats(): void {
    const tenants &#x3D; Array.from(this.tenantsMap.values());
    const users &#x3D; Array.from(this.tenantUsersMap.values());

    const newStats: TenantStats &#x3D; {
      totalTenants: tenants.length,
      activeTenants: tenants.filter(t &#x3D;&gt; t.status &#x3D;&#x3D;&#x3D; &#x27;active&#x27;).length,
      inactiveTenants: tenants.filter(t &#x3D;&gt; t.status &#x3D;&#x3D;&#x3D; &#x27;inactive&#x27;).length,
      suspendedTenants: tenants.filter(t &#x3D;&gt; t.status &#x3D;&#x3D;&#x3D; &#x27;suspended&#x27;).length,
      tenantsByPlan: this.groupTenantsByPlan(tenants),
      totalUsers: users.length,
      totalDevices: tenants.reduce((sum, t) &#x3D;&gt; sum + t.usage.devices, 0),
      totalStorage: tenants.reduce((sum, t) &#x3D;&gt; sum + t.usage.storage, 0),
      totalApiCalls: tenants.reduce((sum, t) &#x3D;&gt; sum + t.usage.apiCalls, 0),
      totalRevenue: tenants.reduce((sum, t) &#x3D;&gt; sum + t.billing.amount, 0),
      averageUsage: this.calculateAverageUsage(tenants),
      lastActivity: tenants.length &gt; 0 ? tenants[0].updatedAt : null
    };

    this._stats.set(newStats);
  }

  /**
   * Group tenants by plan
   */
  private groupTenantsByPlan(tenants: Tenant[]): { [key: string]: number } {
    return tenants.reduce((acc, tenant) &#x3D;&gt; {
      acc[tenant.plan] &#x3D; (acc[tenant.plan] || 0) + 1;
      return acc;
    }, {} as { [key: string]: number });
  }

  /**
   * Calculate average usage
   */
  private calculateAverageUsage(tenants: Tenant[]): number {
    if (tenants.length &#x3D;&#x3D;&#x3D; 0) return 0;
    const totalUsage &#x3D; tenants.reduce((sum, tenant) &#x3D;&gt; {
      return sum + tenant.usage.users + tenant.usage.devices + tenant.usage.storage;
    }, 0);
    return totalUsage / tenants.length;
  }

  /**
   * Get current configuration
   */
  public getConfig(): MultiTenantConfig {
    return { ...this.configData };
  }

  /**
   * Get current statistics
   */
  public getStats(): TenantStats {
    return this._stats();
  }

  /**
   * Generate unique ID
   */
  private generateId(): string {
    return &#x27;tenant_&#x27; + Date.now() + &#x27;_&#x27; + Math.random().toString(36).substr(2, 9);
  }

  /**
   * Cleanup resources
   */
  public cleanup(): void {
    this.tenantsMap.clear();
    this.tenantUsersMap.clear();
    this.tenantConfigsMap.clear();
  }
}

</code></pre>
    </div>
</div>








                   </div><div class="search-results">
    <div class="has-results">
        <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
        <ul class="search-results-list"></ul>
    </div>
    <div class="no-results">
        <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
    </div>
</div>
</div>
               <!-- END CONTENT -->
           </div>
       </div>

          <label class="dark-mode-switch">
               <input type="checkbox">
               <span class="slider">
                    <svg class="slider-icon" viewBox="0 0 24 24" fill="none" height="20" stroke="#000" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" width="20" xmlns="http://www.w3.org/2000/svg">
                    <path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"></path>
                    </svg>
               </span>
          </label>

       <script>
            var COMPODOC_CURRENT_PAGE_DEPTH = 1;
            var COMPODOC_CURRENT_PAGE_CONTEXT = 'interface';
            var COMPODOC_CURRENT_PAGE_URL = 'MultiTenantConfig.html';
            var MAX_SEARCH_RESULTS = 15;
       </script>

       <script>
               $darkModeToggleSwitchers = document.querySelectorAll('.dark-mode-switch input');
               checkToggle(darkModeState);
               if ($darkModeToggleSwitchers.length > 0) {
                    for (var i = 0; i < $darkModeToggleSwitchers.length; i++) {
                         $darkModeToggleSwitchers[i].addEventListener('change', function (event) {
                              darkModeState = !darkModeState;
                              toggleDarkMode(darkModeState);
                         });
                    }
               }
          </script>

       <script src="../js/libs/custom-elements.min.js"></script>
       <script src="../js/libs/lit-html.js"></script>

       <script src="../js/menu-wc.js" defer></script>
       <script nomodule src="../js/menu-wc_es5.js" defer></script>

       <script src="../js/libs/bootstrap-native.js"></script>

       <script src="../js/libs/es6-shim.min.js"></script>
       <script src="../js/libs/EventDispatcher.js"></script>
       <script src="../js/libs/promise.min.js"></script>

       <script src="../js/compodoc.js"></script>

       <script src="../js/tabs.js"></script>
       <script src="../js/menu.js"></script>
       <script src="../js/libs/clipboard.min.js"></script>
       <script src="../js/libs/prism.js"></script>
       <script src="../js/sourceCode.js"></script>
          <script src="../js/search/search.js"></script>
          <script src="../js/search/lunr.min.js"></script>
          <script src="../js/search/search-lunr.js"></script>
          <script src="../js/search/search_index.js"></script>
       <script src="../js/lazy-load-graphs.js"></script>


    </body>
</html>
