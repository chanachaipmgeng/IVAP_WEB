<!doctype html>
<html class="no-js" lang="">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="x-ua-compatible" content="ie=edge">
        <title>frontend documentation</title>
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <link rel="icon" type="image/x-icon" href="../images/favicon.ico">
	   <link rel="stylesheet" href="../styles/style.css">
        <link rel="stylesheet" href="../styles/dark.css">
    </head>
    <body>
          <script>
               // Blocking script to avoid flickering dark mode
               // Dark mode toggle button
               var useDark = window.matchMedia('(prefers-color-scheme: dark)');
               var darkModeState = useDark.matches;
               var $darkModeToggleSwitchers = document.querySelectorAll('.dark-mode-switch input');
               var $darkModeToggles = document.querySelectorAll('.dark-mode-switch');
               var darkModeStateLocal = localStorage.getItem('compodoc_darkmode-state');

               function checkToggle(check) {
                    for (var i = 0; i < $darkModeToggleSwitchers.length; i++) {
                         $darkModeToggleSwitchers[i].checked = check;
                    }
               }

               function toggleDarkMode(state) {
                    if (window.localStorage) {
                         localStorage.setItem('compodoc_darkmode-state', state);
                    }

                    checkToggle(state);

                    const hasClass = document.body.classList.contains('dark');

                    if (state) {
                         for (var i = 0; i < $darkModeToggles.length; i++) {
                              $darkModeToggles[i].classList.add('dark');
                         }
                         if (!hasClass) {
                              document.body.classList.add('dark');
                         }
                    } else {
                         for (var i = 0; i < $darkModeToggles.length; i++) {
                              $darkModeToggles[i].classList.remove('dark');
                         }
                         if (hasClass) {
                              document.body.classList.remove('dark');
                         }
                    }
               }

               useDark.addEventListener('change', function (evt) {
                    toggleDarkMode(evt.matches);
               });
               if (darkModeStateLocal) {
                    darkModeState = darkModeStateLocal === 'true';
               }
               toggleDarkMode(darkModeState);
          </script>
          <script>
              // --- Iframe navigation tracking for Template Playground ---
              function sendCurrentUrlToParent() {
                  if (window.parent && window.parent !== window) {
                      window.parent.postMessage({
                          type: 'compodoc-iframe-navigate',
                          url: window.location.pathname + window.location.hash
                      }, '*');
                  }
              }
              window.addEventListener('hashchange', sendCurrentUrlToParent, false);
              window.addEventListener('popstate', sendCurrentUrlToParent, false);
              window.addEventListener('DOMContentLoaded', sendCurrentUrlToParent, false);
          </script>

        <div class="navbar navbar-default navbar-fixed-top d-md-none p-0">
               <div class="d-flex">
                    <a href="../" class="navbar-brand">frontend documentation</a>
                    <button type="button" class="btn btn-default btn-menu ion-ios-menu" id="btn-menu"></button>
               </div>
        </div>

        <div class="xs-menu menu" id="mobile-menu">
                <div id="book-search-input" role="search"><input type="text" placeholder="Type to search"></div>            <compodoc-menu></compodoc-menu>
        </div>

        <div class="container-fluid main">
           <div class="row main">
               <div class="d-none d-md-block menu">
                   <compodoc-menu mode="normal"></compodoc-menu>
               </div>
               <!-- START CONTENT -->
               <div class="content interface">
                   <div class="content-data">

















<ol class="breadcrumb">
  <li class="breadcrumb-item">Interfaces</li>
  <li class="breadcrumb-item"
  >
  ReportSchedule</li>
</ol>

<ul class="nav nav-tabs" role="tablist">
        <li class="nav-item">
            <a href="#info" 
                class="nav-link"
                class="nav-link active"
                role="tab" id="info-tab" data-bs-toggle="tab" data-link="info">Info</a>
        </li>
        <li class="nav-item">
            <a href="#source" 
                class="nav-link"
                
                role="tab" id="source-tab" data-bs-toggle="tab" data-link="source">Source</a>
        </li>
</ul>

<div class="tab-content">
    <div class="tab-pane fade active in" id="info">
        <p class="comment">
            <h3>File</h3>
        </p>
        <p class="comment">
            <code>src/app/core/services/advanced-reports.service.ts</code>
        </p>




        <section data-compodoc="block-index">
            <h3 id="index">Index</h3>
            <table class="table table-sm table-bordered index-table">
                <tbody>
                    <tr>
                        <td class="col-md-4">
                            <h6><b>Properties</b></h6>
                        </td>
                    </tr>
                    <tr>
                        <td class="col-md-4">
                            <ul class="index-list">
                                <li>
                                        <a href="#createdAt" 
>
                                            createdAt
                                        </a>
                                </li>
                                <li>
                                        <a href="#enabled" 
>
                                            enabled
                                        </a>
                                </li>
                                <li>
                                        <a href="#frequency" 
>
                                            frequency
                                        </a>
                                </li>
                                <li>
                                        <a href="#id" 
>
                                            id
                                        </a>
                                </li>
                                <li>
                                            <span class="modifier">Optional</span>
                                        <a href="#lastRun" 
>
                                            lastRun
                                        </a>
                                </li>
                                <li>
                                        <a href="#name" 
>
                                            name
                                        </a>
                                </li>
                                <li>
                                        <a href="#nextRun" 
>
                                            nextRun
                                        </a>
                                </li>
                                <li>
                                        <a href="#recipients" 
>
                                            recipients
                                        </a>
                                </li>
                                <li>
                                        <a href="#templateId" 
>
                                            templateId
                                        </a>
                                </li>
                                <li>
                                        <a href="#time" 
>
                                            time
                                        </a>
                                </li>
                                <li>
                                        <a href="#updatedAt" 
>
                                            updatedAt
                                        </a>
                                </li>
                            </ul>
                        </td>
                    </tr>
                </tbody>
            </table>
        </section>



            <section data-compodoc="block-properties">
                <h3 id="inputs">Properties</h3>
                    <table class="table table-sm table-bordered">
                        <tbody>
                                <tr>
                                    <td class="col-md-4">
                                        <a name="createdAt"></a>
                                        <span class="name "><b>createdAt</b>
                                            <a href="#createdAt">
                                                <span class="icon ion-ios-link"></span>
                                            </a>
                                        </span>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="col-md-4">
                                        <code>createdAt:         <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Date" target="_blank" >Date</a></code>
</code>
                                    </td>
                                </tr>


                                    <tr>
                                        <td class="col-md-4">
                                            <i>Type : </i>        <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Date" target="_blank" >Date</a></code>

                                        </td>
                                    </tr>





                        </tbody>
                    </table>
                    <table class="table table-sm table-bordered">
                        <tbody>
                                <tr>
                                    <td class="col-md-4">
                                        <a name="enabled"></a>
                                        <span class="name "><b>enabled</b>
                                            <a href="#enabled">
                                                <span class="icon ion-ios-link"></span>
                                            </a>
                                        </span>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="col-md-4">
                                        <code>enabled:         <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/boolean" target="_blank" >boolean</a></code>
</code>
                                    </td>
                                </tr>


                                    <tr>
                                        <td class="col-md-4">
                                            <i>Type : </i>        <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/boolean" target="_blank" >boolean</a></code>

                                        </td>
                                    </tr>





                        </tbody>
                    </table>
                    <table class="table table-sm table-bordered">
                        <tbody>
                                <tr>
                                    <td class="col-md-4">
                                        <a name="frequency"></a>
                                        <span class="name "><b>frequency</b>
                                            <a href="#frequency">
                                                <span class="icon ion-ios-link"></span>
                                            </a>
                                        </span>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="col-md-4">
                                        <code>frequency:     <code>&quot;daily&quot; | &quot;weekly&quot; | &quot;monthly&quot; | &quot;quarterly&quot; | &quot;yearly&quot;</code>
</code>
                                    </td>
                                </tr>


                                    <tr>
                                        <td class="col-md-4">
                                            <i>Type : </i>    <code>&quot;daily&quot; | &quot;weekly&quot; | &quot;monthly&quot; | &quot;quarterly&quot; | &quot;yearly&quot;</code>

                                        </td>
                                    </tr>





                        </tbody>
                    </table>
                    <table class="table table-sm table-bordered">
                        <tbody>
                                <tr>
                                    <td class="col-md-4">
                                        <a name="id"></a>
                                        <span class="name "><b>id</b>
                                            <a href="#id">
                                                <span class="icon ion-ios-link"></span>
                                            </a>
                                        </span>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="col-md-4">
                                        <code>id:         <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>
</code>
                                    </td>
                                </tr>


                                    <tr>
                                        <td class="col-md-4">
                                            <i>Type : </i>        <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>

                                        </td>
                                    </tr>





                        </tbody>
                    </table>
                    <table class="table table-sm table-bordered">
                        <tbody>
                                <tr>
                                    <td class="col-md-4">
                                        <a name="lastRun"></a>
                                        <span class="name "><b>lastRun</b>
                                            <a href="#lastRun">
                                                <span class="icon ion-ios-link"></span>
                                            </a>
                                        </span>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="col-md-4">
                                        <code>lastRun:         <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Date" target="_blank" >Date</a></code>
</code>
                                    </td>
                                </tr>


                                    <tr>
                                        <td class="col-md-4">
                                            <i>Type : </i>        <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Date" target="_blank" >Date</a></code>

                                        </td>
                                    </tr>

                                    <tr>
                                        <td class="col-md-4">
                                            <i>Optional</i>
                                        </td>
                                    </tr>




                        </tbody>
                    </table>
                    <table class="table table-sm table-bordered">
                        <tbody>
                                <tr>
                                    <td class="col-md-4">
                                        <a name="name"></a>
                                        <span class="name "><b>name</b>
                                            <a href="#name">
                                                <span class="icon ion-ios-link"></span>
                                            </a>
                                        </span>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="col-md-4">
                                        <code>name:         <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>
</code>
                                    </td>
                                </tr>


                                    <tr>
                                        <td class="col-md-4">
                                            <i>Type : </i>        <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>

                                        </td>
                                    </tr>





                        </tbody>
                    </table>
                    <table class="table table-sm table-bordered">
                        <tbody>
                                <tr>
                                    <td class="col-md-4">
                                        <a name="nextRun"></a>
                                        <span class="name "><b>nextRun</b>
                                            <a href="#nextRun">
                                                <span class="icon ion-ios-link"></span>
                                            </a>
                                        </span>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="col-md-4">
                                        <code>nextRun:         <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Date" target="_blank" >Date</a></code>
</code>
                                    </td>
                                </tr>


                                    <tr>
                                        <td class="col-md-4">
                                            <i>Type : </i>        <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Date" target="_blank" >Date</a></code>

                                        </td>
                                    </tr>





                        </tbody>
                    </table>
                    <table class="table table-sm table-bordered">
                        <tbody>
                                <tr>
                                    <td class="col-md-4">
                                        <a name="recipients"></a>
                                        <span class="name "><b>recipients</b>
                                            <a href="#recipients">
                                                <span class="icon ion-ios-link"></span>
                                            </a>
                                        </span>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="col-md-4">
                                        <code>recipients:     <code>string[]</code>
</code>
                                    </td>
                                </tr>


                                    <tr>
                                        <td class="col-md-4">
                                            <i>Type : </i>    <code>string[]</code>

                                        </td>
                                    </tr>





                        </tbody>
                    </table>
                    <table class="table table-sm table-bordered">
                        <tbody>
                                <tr>
                                    <td class="col-md-4">
                                        <a name="templateId"></a>
                                        <span class="name "><b>templateId</b>
                                            <a href="#templateId">
                                                <span class="icon ion-ios-link"></span>
                                            </a>
                                        </span>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="col-md-4">
                                        <code>templateId:         <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>
</code>
                                    </td>
                                </tr>


                                    <tr>
                                        <td class="col-md-4">
                                            <i>Type : </i>        <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>

                                        </td>
                                    </tr>





                        </tbody>
                    </table>
                    <table class="table table-sm table-bordered">
                        <tbody>
                                <tr>
                                    <td class="col-md-4">
                                        <a name="time"></a>
                                        <span class="name "><b>time</b>
                                            <a href="#time">
                                                <span class="icon ion-ios-link"></span>
                                            </a>
                                        </span>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="col-md-4">
                                        <code>time:         <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>
</code>
                                    </td>
                                </tr>


                                    <tr>
                                        <td class="col-md-4">
                                            <i>Type : </i>        <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>

                                        </td>
                                    </tr>





                        </tbody>
                    </table>
                    <table class="table table-sm table-bordered">
                        <tbody>
                                <tr>
                                    <td class="col-md-4">
                                        <a name="updatedAt"></a>
                                        <span class="name "><b>updatedAt</b>
                                            <a href="#updatedAt">
                                                <span class="icon ion-ios-link"></span>
                                            </a>
                                        </span>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="col-md-4">
                                        <code>updatedAt:         <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Date" target="_blank" >Date</a></code>
</code>
                                    </td>
                                </tr>


                                    <tr>
                                        <td class="col-md-4">
                                            <i>Type : </i>        <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Date" target="_blank" >Date</a></code>

                                        </td>
                                    </tr>





                        </tbody>
                    </table>
            </section>
    </div>


    <div class="tab-pane fade  tab-source-code" id="source">
        <pre class="line-numbers compodoc-sourcecode"><code class="language-typescript">import { Injectable, signal, computed } from &#x27;@angular/core&#x27;;
import { Observable } from &#x27;rxjs&#x27;;

export interface ReportTemplate {
  id: string;
  name: string;
  description: string;
  category: &#x27;security&#x27; | &#x27;attendance&#x27; | &#x27;performance&#x27; | &#x27;compliance&#x27; | &#x27;custom&#x27;;
  type: &#x27;summary&#x27; | &#x27;detailed&#x27; | &#x27;analytical&#x27; | &#x27;comparative&#x27; | &#x27;trend&#x27;;
  dataSource: string[];
  filters: {
    [key: string]: any;
  };
  metrics: {
    [key: string]: {
      type: &#x27;count&#x27; | &#x27;sum&#x27; | &#x27;average&#x27; | &#x27;percentage&#x27; | &#x27;trend&#x27; | &#x27;distribution&#x27;;
      field: string;
      label: string;
      format?: string;
    };
  };
  visualizations: {
    type: &#x27;chart&#x27; | &#x27;table&#x27; | &#x27;map&#x27; | &#x27;gauge&#x27; | &#x27;heatmap&#x27; | &#x27;timeline&#x27;;
    config: {
      [key: string]: any;
    };
  }[];
  schedule?: {
    enabled: boolean;
    frequency: &#x27;daily&#x27; | &#x27;weekly&#x27; | &#x27;monthly&#x27; | &#x27;quarterly&#x27; | &#x27;yearly&#x27;;
    time: string; // HH:mm format
  recipients: string[];
  };
  createdAt: Date;
  updatedAt: Date;
  createdBy: string;
}

export interface ReportData {
  id: string;
  templateId: string;
  name: string;
  data: any;
  filters: {
    [key: string]: any;
  };
  generatedAt: Date;
  generatedBy: string;
  status: &#x27;generating&#x27; | &#x27;completed&#x27; | &#x27;failed&#x27;;
  filePath?: string;
  fileSize?: number;
  downloadCount: number;
}

export interface ReportSchedule {
  id: string;
  templateId: string;
  name: string;
  enabled: boolean;
  frequency: &#x27;daily&#x27; | &#x27;weekly&#x27; | &#x27;monthly&#x27; | &#x27;quarterly&#x27; | &#x27;yearly&#x27;;
  time: string;
  recipients: string[];
  lastRun?: Date;
  nextRun: Date;
  createdAt: Date;
  updatedAt: Date;
}

export interface ReportStats {
  totalReports: number;
  reportsByCategory: { [key: string]: number };
  reportsByType: { [key: string]: number };
  totalTemplates: number;
  activeSchedules: number;
  totalDownloads: number;
  averageGenerationTime: number;
  lastGenerated: Date | null;
}

export interface ReportConfig {
  enabled: boolean;
  maxConcurrentGenerations: number;
  defaultFormat: &#x27;pdf&#x27; | &#x27;excel&#x27; | &#x27;csv&#x27; | &#x27;json&#x27;;
  compressionEnabled: boolean;
  encryptionEnabled: boolean;
  retentionDays: number;
  autoCleanup: boolean;
  emailNotifications: boolean;
  webhookNotifications: boolean;
  storagePath: string;
}

@Injectable({
  providedIn: &#x27;root&#x27;
})
export class AdvancedReportsService {
  private templatesMap: Map&lt;string, ReportTemplate&gt; &#x3D; new Map();
  private reportsMap: Map&lt;string, ReportData&gt; &#x3D; new Map();
  private schedulesMap: Map&lt;string, ReportSchedule&gt; &#x3D; new Map();
  private configData: ReportConfig &#x3D; this.getDefaultConfig();

  // ✅ Signals for reactive state
  private _templates &#x3D; signal&lt;ReportTemplate[]&gt;([]);
  private _reports &#x3D; signal&lt;ReportData[]&gt;([]);
  private _schedules &#x3D; signal&lt;ReportSchedule[]&gt;([]);
  private _stats &#x3D; signal&lt;ReportStats&gt;(this.getInitialStats());
  private _config &#x3D; signal&lt;ReportConfig&gt;(this.configData);

  // ✅ Readonly signals for public access
  public readonly templates &#x3D; this._templates.asReadonly();
  public readonly reports &#x3D; this._reports.asReadonly();
  public readonly schedules &#x3D; this._schedules.asReadonly();
  public readonly stats &#x3D; this._stats.asReadonly();
  public readonly config &#x3D; this._config.asReadonly();

  // ✅ Computed signals for derived state
  public readonly templatesCount &#x3D; computed(() &#x3D;&gt; this._templates().length);
  public readonly reportsCount &#x3D; computed(() &#x3D;&gt; this._reports().length);
  public readonly schedulesCount &#x3D; computed(() &#x3D;&gt; this._schedules().length);

  constructor() {
    this.initializeService();
  }

  /**
   * Initialize service
   */
  private initializeService(): void {
    this.loadConfig();
    this.loadTemplates();
    this.loadReports();
    this.loadSchedules();
  }

  /**
   * Get default configuration
   */
  private getDefaultConfig(): ReportConfig {
    return {
      enabled: true,
      maxConcurrentGenerations: 5,
      defaultFormat: &#x27;pdf&#x27;,
      compressionEnabled: true,
      encryptionEnabled: false,
      retentionDays: 90,
      autoCleanup: true,
      emailNotifications: true,
      webhookNotifications: false,
      storagePath: &#x27;/reports&#x27;
    };
  }

  /**
   * Get initial stats
   */
  private getInitialStats(): ReportStats {
    return {
      totalReports: 0,
      reportsByCategory: {},
      reportsByType: {},
      totalTemplates: 0,
      activeSchedules: 0,
      totalDownloads: 0,
      averageGenerationTime: 0,
      lastGenerated: null
    };
  }

  /**
   * Load configuration
   */
  private loadConfig(): void {
    try {
      const stored &#x3D; localStorage.getItem(&#x27;advanced_reports_config&#x27;);
      if (stored) {
        this.configData &#x3D; { ...this.configData, ...JSON.parse(stored) };
        this._config.set(this.configData);
      }
    } catch (error) {
      console.error(&#x27;Failed to load advanced reports config:&#x27;, error);
    }
  }

  /**
   * Save configuration
   */
  private saveConfig(): void {
    try {
      localStorage.setItem(&#x27;advanced_reports_config&#x27;, JSON.stringify(this.configData));
    } catch (error) {
      console.error(&#x27;Failed to save advanced reports config:&#x27;, error);
    }
  }

  /**
   * Load templates
   */
  private loadTemplates(): void {
    try {
      const stored &#x3D; localStorage.getItem(&#x27;advanced_reports_templates&#x27;);
      if (stored) {
        const templates &#x3D; JSON.parse(stored);
        templates.forEach((template: any) &#x3D;&gt; {
          template.createdAt &#x3D; new Date(template.createdAt);
          template.updatedAt &#x3D; new Date(template.updatedAt);
          this.templatesMap.set(template.id, template);
        });
        this._templates.set(Array.from(this.templatesMap.values()));
      }
    } catch (error) {
      console.error(&#x27;Failed to load advanced reports templates:&#x27;, error);
    }
  }

  /**
   * Save templates
   */
  private saveTemplates(): void {
    try {
      const templates &#x3D; Array.from(this.templatesMap.values());
      localStorage.setItem(&#x27;advanced_reports_templates&#x27;, JSON.stringify(templates));
    } catch (error) {
      console.error(&#x27;Failed to save advanced reports templates:&#x27;, error);
    }
  }

  /**
   * Load reports
   */
  private loadReports(): void {
    try {
      const stored &#x3D; localStorage.getItem(&#x27;advanced_reports_data&#x27;);
      if (stored) {
        const reports &#x3D; JSON.parse(stored);
        reports.forEach((report: any) &#x3D;&gt; {
          report.generatedAt &#x3D; new Date(report.generatedAt);
          this.reportsMap.set(report.id, report);
        });
        this._reports.set(Array.from(this.reportsMap.values()));
      }
    } catch (error) {
      console.error(&#x27;Failed to load advanced reports data:&#x27;, error);
    }
  }

  /**
   * Save reports
   */
  private saveReports(): void {
    try {
      const reports &#x3D; Array.from(this.reportsMap.values());
      localStorage.setItem(&#x27;advanced_reports_data&#x27;, JSON.stringify(reports));
    } catch (error) {
      console.error(&#x27;Failed to save advanced reports data:&#x27;, error);
    }
  }

  /**
   * Load schedules
   */
  private loadSchedules(): void {
    try {
      const stored &#x3D; localStorage.getItem(&#x27;advanced_reports_schedules&#x27;);
      if (stored) {
        const schedules &#x3D; JSON.parse(stored);
        schedules.forEach((schedule: any) &#x3D;&gt; {
          schedule.createdAt &#x3D; new Date(schedule.createdAt);
          schedule.updatedAt &#x3D; new Date(schedule.updatedAt);
          schedule.lastRun &#x3D; schedule.lastRun ? new Date(schedule.lastRun) : undefined;
          schedule.nextRun &#x3D; new Date(schedule.nextRun);
          this.schedulesMap.set(schedule.id, schedule);
        });
        this._schedules.set(Array.from(this.schedulesMap.values()));
      }
    } catch (error) {
      console.error(&#x27;Failed to load advanced reports schedules:&#x27;, error);
    }
  }

  /**
   * Save schedules
   */
  private saveSchedules(): void {
    try {
      const schedules &#x3D; Array.from(this.schedulesMap.values());
      localStorage.setItem(&#x27;advanced_reports_schedules&#x27;, JSON.stringify(schedules));
    } catch (error) {
      console.error(&#x27;Failed to save advanced reports schedules:&#x27;, error);
    }
  }

  /**
   * Create report template
   */
  public createTemplate(template: Omit&lt;ReportTemplate, &#x27;id&#x27; | &#x27;createdAt&#x27; | &#x27;updatedAt&#x27;&gt;): string {
    const id &#x3D; this.generateId();
    const newTemplate: ReportTemplate &#x3D; {
      ...template,
      id,
      createdAt: new Date(),
      updatedAt: new Date()
    };

    this.templatesMap.set(id, newTemplate);
    this._templates.set(Array.from(this.templatesMap.values()));
    this.saveTemplates();
    this.updateStats();
    return id;
  }

  /**
   * Update template
   */
  public updateTemplate(id: string, updates: Partial&lt;ReportTemplate&gt;): void {
    const template &#x3D; this.templatesMap.get(id);
    if (template) {
      const updatedTemplate &#x3D; { ...template, ...updates, updatedAt: new Date() };
      this.templatesMap.set(id, updatedTemplate);
      this._templates.set(Array.from(this.templatesMap.values()));
      this.saveTemplates();
    }
  }

  /**
   * Delete template
   */
  public deleteTemplate(id: string): void {
    this.templatesMap.delete(id);
    this._templates.set(Array.from(this.templatesMap.values()));
    this.saveTemplates();
    this.updateStats();
  }

  /**
   * Generate report
   */
  public async generateReport(templateId: string, filters: { [key: string]: any }, name?: string): Promise&lt;string&gt; {
    const template &#x3D; this.templatesMap.get(templateId);
    if (!template) {
      throw new Error(&#x27;Template not found&#x27;);
    }

    const reportId &#x3D; this.generateId();
    const report: ReportData &#x3D; {
      id: reportId,
      templateId,
      name: name || &#x60;${template.name} - ${new Date().toLocaleString()}&#x60;,
      data: {},
      filters,
      generatedAt: new Date(),
      generatedBy: &#x27;current_user&#x27;, // In real app, get from auth service
      status: &#x27;generating&#x27;,
      downloadCount: 0
    };

    this.reportsMap.set(reportId, report);
    this._reports.set(Array.from(this.reportsMap.values()));

    // Simulate report generation
    try {
      const data &#x3D; await this.generateReportData(template, filters);
      report.data &#x3D; data;
      report.status &#x3D; &#x27;completed&#x27;;
      report.filePath &#x3D; &#x60;/reports/${reportId}.pdf&#x60;;
      report.fileSize &#x3D; Math.floor(Math.random() * 1000000) + 100000; // 100KB - 1MB
    } catch (error) {
      report.status &#x3D; &#x27;failed&#x27;;
      console.error(&#x27;Failed to generate report:&#x27;, error);
    }

    this.reportsMap.set(reportId, report);
    this._reports.set(Array.from(this.reportsMap.values()));
    this.updateStats();

    return reportId;
  }

  /**
   * Generate report data
   */
  private async generateReportData(template: ReportTemplate, filters: { [key: string]: any }): Promise&lt;any&gt; {
    // Simulate data generation
    return new Promise((resolve) &#x3D;&gt; {
      setTimeout(() &#x3D;&gt; {
        const data &#x3D; {
          summary: {
            totalRecords: Math.floor(Math.random() * 10000) + 1000,
            dateRange: {
              start: new Date(Date.now() - 30 * 24 * 60 * 60 * 1000).toISOString(),
              end: new Date().toISOString()
            },
            generatedAt: new Date().toISOString()
          },
          metrics: this.generateMetrics(template.metrics),
          charts: this.generateCharts(template.visualizations),
          tables: this.generateTables(template.visualizations),
          filters: filters
        };
        resolve(data);
      }, 2000); // 2 second delay
    });
  }

  /**
   * Generate metrics
   */
  private generateMetrics(metrics: { [key: string]: any }): { [key: string]: any } {
    const result: { [key: string]: any } &#x3D; {};

    for (const [key, metric] of Object.entries(metrics)) {
      switch (metric.type) {
        case &#x27;count&#x27;:
          result[key] &#x3D; Math.floor(Math.random() * 1000) + 100;
          break;
        case &#x27;sum&#x27;:
          result[key] &#x3D; Math.floor(Math.random() * 100000) + 10000;
          break;
        case &#x27;average&#x27;:
          result[key] &#x3D; Math.floor(Math.random() * 100) + 10;
          break;
        case &#x27;percentage&#x27;:
          result[key] &#x3D; Math.floor(Math.random() * 100);
          break;
        case &#x27;trend&#x27;:
          result[key] &#x3D; Math.floor(Math.random() * 20) - 10; // -10 to +10
          break;
        case &#x27;distribution&#x27;:
          result[key] &#x3D; {
            &#x27;Category A&#x27;: Math.floor(Math.random() * 100),
            &#x27;Category B&#x27;: Math.floor(Math.random() * 100),
            &#x27;Category C&#x27;: Math.floor(Math.random() * 100)
          };
          break;
      }
    }

    return result;
  }

  /**
   * Generate charts
   */
  private generateCharts(visualizations: any[]): any[] {
    return visualizations
      .filter(viz &#x3D;&gt; viz.type &#x3D;&#x3D;&#x3D; &#x27;chart&#x27;)
      .map(viz &#x3D;&gt; ({
        type: viz.type,
        title: &#x60;Chart ${Math.floor(Math.random() * 100)}&#x60;,
        data: this.generateChartData(viz.config.chartType || &#x27;line&#x27;)
      }));
  }

  /**
   * Generate chart data
   */
  private generateChartData(chartType: string): any {
    const dataPoints &#x3D; 12; // 12 months
    const data &#x3D; [];

    for (let i &#x3D; 0; i &lt; dataPoints; i++) {
      data.push({
        x: new Date(Date.now() - (dataPoints - i) * 30 * 24 * 60 * 60 * 1000).toISOString(),
        y: Math.floor(Math.random() * 1000) + 100
      });
    }

    return data;
  }

  /**
   * Generate tables
   */
  private generateTables(visualizations: any[]): any[] {
    return visualizations
      .filter(viz &#x3D;&gt; viz.type &#x3D;&#x3D;&#x3D; &#x27;table&#x27;)
      .map(viz &#x3D;&gt; ({
        type: viz.type,
        title: &#x60;Table ${Math.floor(Math.random() * 100)}&#x60;,
        columns: [&#x27;Name&#x27;, &#x27;Value&#x27;, &#x27;Status&#x27;, &#x27;Date&#x27;],
        data: Array.from({ length: 10 }, (_, i) &#x3D;&gt; ({
          name: &#x60;Item ${i + 1}&#x60;,
          value: Math.floor(Math.random() * 1000),
          status: [&#x27;Active&#x27;, &#x27;Inactive&#x27;, &#x27;Pending&#x27;][Math.floor(Math.random() * 3)],
          date: new Date(Date.now() - Math.random() * 30 * 24 * 60 * 60 * 1000).toISOString()
        }))
      }));
  }

  /**
   * Create schedule
   */
  public createSchedule(schedule: Omit&lt;ReportSchedule, &#x27;id&#x27; | &#x27;createdAt&#x27; | &#x27;updatedAt&#x27; | &#x27;nextRun&#x27;&gt;): string {
    const id &#x3D; this.generateId();
    const nextRun &#x3D; this.calculateNextRun(schedule.frequency, schedule.time);

    const newSchedule: ReportSchedule &#x3D; {
      ...schedule,
      id,
      createdAt: new Date(),
      updatedAt: new Date(),
      nextRun
    };

    this.schedulesMap.set(id, newSchedule);
    this._schedules.set(Array.from(this.schedulesMap.values()));
    this.saveSchedules();
    this.updateStats();
    return id;
  }

  /**
   * Update schedule
   */
  public updateSchedule(id: string, updates: Partial&lt;ReportSchedule&gt;): void {
    const schedule &#x3D; this.schedulesMap.get(id);
    if (schedule) {
      const updatedSchedule &#x3D; { ...schedule, ...updates, updatedAt: new Date() };
      if (updates.frequency || updates.time) {
        updatedSchedule.nextRun &#x3D; this.calculateNextRun(updatedSchedule.frequency, updatedSchedule.time);
      }
      this.schedulesMap.set(id, updatedSchedule);
      this._schedules.set(Array.from(this.schedulesMap.values()));
      this.saveSchedules();
    }
  }

  /**
   * Delete schedule
   */
  public deleteSchedule(id: string): void {
    this.schedulesMap.delete(id);
    this._schedules.set(Array.from(this.schedulesMap.values()));
    this.saveSchedules();
    this.updateStats();
  }

  /**
   * Calculate next run time
   */
  private calculateNextRun(frequency: string, time: string): Date {
    const now &#x3D; new Date();
    const [hours, minutes] &#x3D; time.split(&#x27;:&#x27;).map(Number);

    let nextRun &#x3D; new Date();
    nextRun.setHours(hours, minutes, 0, 0);

    switch (frequency) {
        case &#x27;daily&#x27;:
        if (nextRun &lt;&#x3D; now) {
          nextRun.setDate(nextRun.getDate() + 1);
        }
          break;
        case &#x27;weekly&#x27;:
        nextRun.setDate(nextRun.getDate() + 7);
          break;
        case &#x27;monthly&#x27;:
        nextRun.setMonth(nextRun.getMonth() + 1);
        break;
      case &#x27;quarterly&#x27;:
        nextRun.setMonth(nextRun.getMonth() + 3);
        break;
      case &#x27;yearly&#x27;:
        nextRun.setFullYear(nextRun.getFullYear() + 1);
          break;
      }

    return nextRun;
  }

  /**
   * Download report
   */
  public downloadReport(reportId: string): void {
    const report &#x3D; this.reportsMap.get(reportId);
    if (report) {
      report.downloadCount++;
      this.reportsMap.set(reportId, report);
      this._reports.set(Array.from(this.reportsMap.values()));
      this.updateStats();

      // Simulate download
      // Report download initiated
    }
  }

  /**
   * Delete report
   */
  public deleteReport(reportId: string): void {
    this.reportsMap.delete(reportId);
    this._reports.set(Array.from(this.reportsMap.values()));
    this.updateStats();
  }

  /**
   * Update configuration
   */
  public updateConfig(updates: Partial&lt;ReportConfig&gt;): void {
    this.configData &#x3D; { ...this.configData, ...updates };
    this._config.set(this.configData);
    this.saveConfig();
  }

  /**
   * Get reports by template
   */
  public getReportsByTemplate(templateId: string): ReportData[] {
    return Array.from(this.reportsMap.values())
      .filter(report &#x3D;&gt; report.templateId &#x3D;&#x3D;&#x3D; templateId)
      .sort((a, b) &#x3D;&gt; b.generatedAt.getTime() - a.generatedAt.getTime());
  }

  /**
   * Get reports by category
   */
  public getReportsByCategory(category: string): ReportData[] {
    const templateIds &#x3D; Array.from(this.templatesMap.values())
      .filter(template &#x3D;&gt; template.category &#x3D;&#x3D;&#x3D; category)
      .map(template &#x3D;&gt; template.id);

    return Array.from(this.reportsMap.values())
      .filter(report &#x3D;&gt; templateIds.includes(report.templateId))
      .sort((a, b) &#x3D;&gt; b.generatedAt.getTime() - a.generatedAt.getTime());
  }

  /**
   * Update statistics
   */
  private updateStats(): void {
    const reports &#x3D; Array.from(this.reportsMap.values());
    const templates &#x3D; Array.from(this.templatesMap.values());
    const schedules &#x3D; Array.from(this.schedulesMap.values());

    const newStats: ReportStats &#x3D; {
      totalReports: reports.length,
      reportsByCategory: this.groupReportsByCategory(reports, templates),
      reportsByType: this.groupReportsByType(reports, templates),
      totalTemplates: templates.length,
      activeSchedules: schedules.filter(s &#x3D;&gt; s.enabled).length,
      totalDownloads: reports.reduce((sum, report) &#x3D;&gt; sum + report.downloadCount, 0),
      averageGenerationTime: 2000, // 2 seconds
      lastGenerated: reports.length &gt; 0 ? reports[0].generatedAt : null
    };

    this._stats.set(newStats);
  }

  /**
   * Group reports by category
   */
  private groupReportsByCategory(reports: ReportData[], templates: ReportTemplate[]): { [key: string]: number } {
    const templateMap &#x3D; new Map(templates.map(t &#x3D;&gt; [t.id, t.category]));
    return reports.reduce((acc, report) &#x3D;&gt; {
      const category &#x3D; templateMap.get(report.templateId) || &#x27;unknown&#x27;;
      acc[category] &#x3D; (acc[category] || 0) + 1;
      return acc;
    }, {} as { [key: string]: number });
  }

  /**
   * Group reports by type
   */
  private groupReportsByType(reports: ReportData[], templates: ReportTemplate[]): { [key: string]: number } {
    const templateMap &#x3D; new Map(templates.map(t &#x3D;&gt; [t.id, t.type]));
    return reports.reduce((acc, report) &#x3D;&gt; {
      const type &#x3D; templateMap.get(report.templateId) || &#x27;unknown&#x27;;
      acc[type] &#x3D; (acc[type] || 0) + 1;
      return acc;
    }, {} as { [key: string]: number });
  }

  /**
   * Get current configuration
   */
  public getConfig(): ReportConfig {
    return { ...this.configData };
  }

  /**
   * Get current statistics
   */
  public getStats(): ReportStats {
    return this._stats();
  }

  /**
   * Generate unique ID
   */
  private generateId(): string {
    return &#x27;rep_&#x27; + Date.now() + &#x27;_&#x27; + Math.random().toString(36).substr(2, 9);
  }

  /**
   * Cleanup resources
   */
  public cleanup(): void {
    this.templatesMap.clear();
    this.reportsMap.clear();
    this.schedulesMap.clear();
  }
}

</code></pre>
    </div>
</div>








                   </div><div class="search-results">
    <div class="has-results">
        <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
        <ul class="search-results-list"></ul>
    </div>
    <div class="no-results">
        <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
    </div>
</div>
</div>
               <!-- END CONTENT -->
           </div>
       </div>

          <label class="dark-mode-switch">
               <input type="checkbox">
               <span class="slider">
                    <svg class="slider-icon" viewBox="0 0 24 24" fill="none" height="20" stroke="#000" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" width="20" xmlns="http://www.w3.org/2000/svg">
                    <path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"></path>
                    </svg>
               </span>
          </label>

       <script>
            var COMPODOC_CURRENT_PAGE_DEPTH = 1;
            var COMPODOC_CURRENT_PAGE_CONTEXT = 'interface';
            var COMPODOC_CURRENT_PAGE_URL = 'ReportSchedule.html';
            var MAX_SEARCH_RESULTS = 15;
       </script>

       <script>
               $darkModeToggleSwitchers = document.querySelectorAll('.dark-mode-switch input');
               checkToggle(darkModeState);
               if ($darkModeToggleSwitchers.length > 0) {
                    for (var i = 0; i < $darkModeToggleSwitchers.length; i++) {
                         $darkModeToggleSwitchers[i].addEventListener('change', function (event) {
                              darkModeState = !darkModeState;
                              toggleDarkMode(darkModeState);
                         });
                    }
               }
          </script>

       <script src="../js/libs/custom-elements.min.js"></script>
       <script src="../js/libs/lit-html.js"></script>

       <script src="../js/menu-wc.js" defer></script>
       <script nomodule src="../js/menu-wc_es5.js" defer></script>

       <script src="../js/libs/bootstrap-native.js"></script>

       <script src="../js/libs/es6-shim.min.js"></script>
       <script src="../js/libs/EventDispatcher.js"></script>
       <script src="../js/libs/promise.min.js"></script>

       <script src="../js/compodoc.js"></script>

       <script src="../js/tabs.js"></script>
       <script src="../js/menu.js"></script>
       <script src="../js/libs/clipboard.min.js"></script>
       <script src="../js/libs/prism.js"></script>
       <script src="../js/sourceCode.js"></script>
          <script src="../js/search/search.js"></script>
          <script src="../js/search/lunr.min.js"></script>
          <script src="../js/search/search-lunr.js"></script>
          <script src="../js/search/search_index.js"></script>
       <script src="../js/lazy-load-graphs.js"></script>


    </body>
</html>
