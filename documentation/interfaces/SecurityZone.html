<!doctype html>
<html class="no-js" lang="">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="x-ua-compatible" content="ie=edge">
        <title>frontend documentation</title>
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <link rel="icon" type="image/x-icon" href="../images/favicon.ico">
	   <link rel="stylesheet" href="../styles/style.css">
        <link rel="stylesheet" href="../styles/dark.css">
    </head>
    <body>
          <script>
               // Blocking script to avoid flickering dark mode
               // Dark mode toggle button
               var useDark = window.matchMedia('(prefers-color-scheme: dark)');
               var darkModeState = useDark.matches;
               var $darkModeToggleSwitchers = document.querySelectorAll('.dark-mode-switch input');
               var $darkModeToggles = document.querySelectorAll('.dark-mode-switch');
               var darkModeStateLocal = localStorage.getItem('compodoc_darkmode-state');

               function checkToggle(check) {
                    for (var i = 0; i < $darkModeToggleSwitchers.length; i++) {
                         $darkModeToggleSwitchers[i].checked = check;
                    }
               }

               function toggleDarkMode(state) {
                    if (window.localStorage) {
                         localStorage.setItem('compodoc_darkmode-state', state);
                    }

                    checkToggle(state);

                    const hasClass = document.body.classList.contains('dark');

                    if (state) {
                         for (var i = 0; i < $darkModeToggles.length; i++) {
                              $darkModeToggles[i].classList.add('dark');
                         }
                         if (!hasClass) {
                              document.body.classList.add('dark');
                         }
                    } else {
                         for (var i = 0; i < $darkModeToggles.length; i++) {
                              $darkModeToggles[i].classList.remove('dark');
                         }
                         if (hasClass) {
                              document.body.classList.remove('dark');
                         }
                    }
               }

               useDark.addEventListener('change', function (evt) {
                    toggleDarkMode(evt.matches);
               });
               if (darkModeStateLocal) {
                    darkModeState = darkModeStateLocal === 'true';
               }
               toggleDarkMode(darkModeState);
          </script>
          <script>
              // --- Iframe navigation tracking for Template Playground ---
              function sendCurrentUrlToParent() {
                  if (window.parent && window.parent !== window) {
                      window.parent.postMessage({
                          type: 'compodoc-iframe-navigate',
                          url: window.location.pathname + window.location.hash
                      }, '*');
                  }
              }
              window.addEventListener('hashchange', sendCurrentUrlToParent, false);
              window.addEventListener('popstate', sendCurrentUrlToParent, false);
              window.addEventListener('DOMContentLoaded', sendCurrentUrlToParent, false);
          </script>

        <div class="navbar navbar-default navbar-fixed-top d-md-none p-0">
               <div class="d-flex">
                    <a href="../" class="navbar-brand">frontend documentation</a>
                    <button type="button" class="btn btn-default btn-menu ion-ios-menu" id="btn-menu"></button>
               </div>
        </div>

        <div class="xs-menu menu" id="mobile-menu">
                <div id="book-search-input" role="search"><input type="text" placeholder="Type to search"></div>            <compodoc-menu></compodoc-menu>
        </div>

        <div class="container-fluid main">
           <div class="row main">
               <div class="d-none d-md-block menu">
                   <compodoc-menu mode="normal"></compodoc-menu>
               </div>
               <!-- START CONTENT -->
               <div class="content interface">
                   <div class="content-data">

















<ol class="breadcrumb">
  <li class="breadcrumb-item">Interfaces</li>
  <li class="breadcrumb-item"
  >
  SecurityZone</li>
</ol>

<ul class="nav nav-tabs" role="tablist">
        <li class="nav-item">
            <a href="#info" 
                class="nav-link"
                class="nav-link active"
                role="tab" id="info-tab" data-bs-toggle="tab" data-link="info">Info</a>
        </li>
        <li class="nav-item">
            <a href="#source" 
                class="nav-link"
                
                role="tab" id="source-tab" data-bs-toggle="tab" data-link="source">Source</a>
        </li>
</ul>

<div class="tab-content">
    <div class="tab-pane fade active in" id="info">
        <p class="comment">
            <h3>File</h3>
        </p>
        <p class="comment">
            <code>src/app/core/services/ai-security.service.ts</code>
        </p>




        <section data-compodoc="block-index">
            <h3 id="index">Index</h3>
            <table class="table table-sm table-bordered index-table">
                <tbody>
                    <tr>
                        <td class="col-md-4">
                            <h6><b>Properties</b></h6>
                        </td>
                    </tr>
                    <tr>
                        <td class="col-md-4">
                            <ul class="index-list">
                                <li>
                                        <a href="#coordinates" 
>
                                            coordinates
                                        </a>
                                </li>
                                <li>
                                        <a href="#createdAt" 
>
                                            createdAt
                                        </a>
                                </li>
                                <li>
                                        <a href="#description" 
>
                                            description
                                        </a>
                                </li>
                                <li>
                                        <a href="#enabled" 
>
                                            enabled
                                        </a>
                                </li>
                                <li>
                                        <a href="#id" 
>
                                            id
                                        </a>
                                </li>
                                <li>
                                        <a href="#name" 
>
                                            name
                                        </a>
                                </li>
                                <li>
                                        <a href="#rules" 
>
                                            rules
                                        </a>
                                </li>
                                <li>
                                        <a href="#type" 
>
                                            type
                                        </a>
                                </li>
                                <li>
                                        <a href="#updatedAt" 
>
                                            updatedAt
                                        </a>
                                </li>
                            </ul>
                        </td>
                    </tr>
                </tbody>
            </table>
        </section>



            <section data-compodoc="block-properties">
                <h3 id="inputs">Properties</h3>
                    <table class="table table-sm table-bordered">
                        <tbody>
                                <tr>
                                    <td class="col-md-4">
                                        <a name="coordinates"></a>
                                        <span class="name "><b>coordinates</b>
                                            <a href="#coordinates">
                                                <span class="icon ion-ios-link"></span>
                                            </a>
                                        </span>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="col-md-4">
                                        <code>coordinates:     <code>literal type[]</code>
</code>
                                    </td>
                                </tr>


                                    <tr>
                                        <td class="col-md-4">
                                            <i>Type : </i>    <code>literal type[]</code>

                                        </td>
                                    </tr>





                        </tbody>
                    </table>
                    <table class="table table-sm table-bordered">
                        <tbody>
                                <tr>
                                    <td class="col-md-4">
                                        <a name="createdAt"></a>
                                        <span class="name "><b>createdAt</b>
                                            <a href="#createdAt">
                                                <span class="icon ion-ios-link"></span>
                                            </a>
                                        </span>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="col-md-4">
                                        <code>createdAt:         <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Date" target="_blank" >Date</a></code>
</code>
                                    </td>
                                </tr>


                                    <tr>
                                        <td class="col-md-4">
                                            <i>Type : </i>        <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Date" target="_blank" >Date</a></code>

                                        </td>
                                    </tr>





                        </tbody>
                    </table>
                    <table class="table table-sm table-bordered">
                        <tbody>
                                <tr>
                                    <td class="col-md-4">
                                        <a name="description"></a>
                                        <span class="name "><b>description</b>
                                            <a href="#description">
                                                <span class="icon ion-ios-link"></span>
                                            </a>
                                        </span>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="col-md-4">
                                        <code>description:         <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>
</code>
                                    </td>
                                </tr>


                                    <tr>
                                        <td class="col-md-4">
                                            <i>Type : </i>        <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>

                                        </td>
                                    </tr>





                        </tbody>
                    </table>
                    <table class="table table-sm table-bordered">
                        <tbody>
                                <tr>
                                    <td class="col-md-4">
                                        <a name="enabled"></a>
                                        <span class="name "><b>enabled</b>
                                            <a href="#enabled">
                                                <span class="icon ion-ios-link"></span>
                                            </a>
                                        </span>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="col-md-4">
                                        <code>enabled:         <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/boolean" target="_blank" >boolean</a></code>
</code>
                                    </td>
                                </tr>


                                    <tr>
                                        <td class="col-md-4">
                                            <i>Type : </i>        <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/boolean" target="_blank" >boolean</a></code>

                                        </td>
                                    </tr>





                        </tbody>
                    </table>
                    <table class="table table-sm table-bordered">
                        <tbody>
                                <tr>
                                    <td class="col-md-4">
                                        <a name="id"></a>
                                        <span class="name "><b>id</b>
                                            <a href="#id">
                                                <span class="icon ion-ios-link"></span>
                                            </a>
                                        </span>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="col-md-4">
                                        <code>id:         <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>
</code>
                                    </td>
                                </tr>


                                    <tr>
                                        <td class="col-md-4">
                                            <i>Type : </i>        <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>

                                        </td>
                                    </tr>





                        </tbody>
                    </table>
                    <table class="table table-sm table-bordered">
                        <tbody>
                                <tr>
                                    <td class="col-md-4">
                                        <a name="name"></a>
                                        <span class="name "><b>name</b>
                                            <a href="#name">
                                                <span class="icon ion-ios-link"></span>
                                            </a>
                                        </span>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="col-md-4">
                                        <code>name:         <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>
</code>
                                    </td>
                                </tr>


                                    <tr>
                                        <td class="col-md-4">
                                            <i>Type : </i>        <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>

                                        </td>
                                    </tr>





                        </tbody>
                    </table>
                    <table class="table table-sm table-bordered">
                        <tbody>
                                <tr>
                                    <td class="col-md-4">
                                        <a name="rules"></a>
                                        <span class="name "><b>rules</b>
                                            <a href="#rules">
                                                <span class="icon ion-ios-link"></span>
                                            </a>
                                        </span>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="col-md-4">
                                        <code>rules:     <code>string[]</code>
</code>
                                    </td>
                                </tr>


                                    <tr>
                                        <td class="col-md-4">
                                            <i>Type : </i>    <code>string[]</code>

                                        </td>
                                    </tr>





                        </tbody>
                    </table>
                    <table class="table table-sm table-bordered">
                        <tbody>
                                <tr>
                                    <td class="col-md-4">
                                        <a name="type"></a>
                                        <span class="name "><b>type</b>
                                            <a href="#type">
                                                <span class="icon ion-ios-link"></span>
                                            </a>
                                        </span>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="col-md-4">
                                        <code>type:     <code>&quot;restricted&quot; | &quot;monitored&quot; | &quot;public&quot; | &quot;sensitive&quot;</code>
</code>
                                    </td>
                                </tr>


                                    <tr>
                                        <td class="col-md-4">
                                            <i>Type : </i>    <code>&quot;restricted&quot; | &quot;monitored&quot; | &quot;public&quot; | &quot;sensitive&quot;</code>

                                        </td>
                                    </tr>





                        </tbody>
                    </table>
                    <table class="table table-sm table-bordered">
                        <tbody>
                                <tr>
                                    <td class="col-md-4">
                                        <a name="updatedAt"></a>
                                        <span class="name "><b>updatedAt</b>
                                            <a href="#updatedAt">
                                                <span class="icon ion-ios-link"></span>
                                            </a>
                                        </span>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="col-md-4">
                                        <code>updatedAt:         <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Date" target="_blank" >Date</a></code>
</code>
                                    </td>
                                </tr>


                                    <tr>
                                        <td class="col-md-4">
                                            <i>Type : </i>        <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Date" target="_blank" >Date</a></code>

                                        </td>
                                    </tr>





                        </tbody>
                    </table>
            </section>
    </div>


    <div class="tab-pane fade  tab-source-code" id="source">
        <pre class="line-numbers compodoc-sourcecode"><code class="language-typescript">import { Injectable, signal, computed } from &#x27;@angular/core&#x27;;
import { Observable, Subject } from &#x27;rxjs&#x27;;

export interface SecurityThreat {
  id: string;
  type: &#x27;intrusion&#x27; | &#x27;weapon&#x27; | &#x27;violence&#x27; | &#x27;suspicious_behavior&#x27; | &#x27;crowd_anomaly&#x27; | &#x27;vehicle_anomaly&#x27; | &#x27;fire&#x27; | &#x27;smoke&#x27;;
  severity: &#x27;low&#x27; | &#x27;medium&#x27; | &#x27;high&#x27; | &#x27;critical&#x27;;
  confidence: number; // 0-100
  location: {
    x: number;
    y: number;
    width: number;
    height: number;
  };
  description: string;
  metadata: {
    [key: string]: any;
  };
  timestamp: Date;
  acknowledged: boolean;
  resolved: boolean;
  assignedTo?: string;
  notes?: string;
}

export interface SecurityRule {
  id: string;
  name: string;
  description: string;
  type: &#x27;intrusion&#x27; | &#x27;weapon&#x27; | &#x27;violence&#x27; | &#x27;suspicious_behavior&#x27; | &#x27;crowd_anomaly&#x27; | &#x27;vehicle_anomaly&#x27; | &#x27;fire&#x27; | &#x27;smoke&#x27;;
  enabled: boolean;
  sensitivity: number; // 0-100
  severity: &#x27;low&#x27; | &#x27;medium&#x27; | &#x27;high&#x27; | &#x27;critical&#x27;;
  conditions: {
    [key: string]: any;
  };
  actions: {
    type: &#x27;alert&#x27; | &#x27;notification&#x27; | &#x27;recording&#x27; | &#x27;email&#x27; | &#x27;webhook&#x27; | &#x27;lockdown&#x27; | &#x27;evacuation&#x27;;
    config: {
      [key: string]: any;
    };
  }[];
  createdAt: Date;
  updatedAt: Date;
}

export interface SecurityZone {
  id: string;
  name: string;
  description: string;
  type: &#x27;restricted&#x27; | &#x27;monitored&#x27; | &#x27;public&#x27; | &#x27;sensitive&#x27;;
  coordinates: {
      x: number;
      y: number;
      width: number;
      height: number;
  }[];
  rules: string[]; // Rule IDs
  enabled: boolean;
  createdAt: Date;
  updatedAt: Date;
}

export interface SecurityStats {
  totalThreats: number;
  threatsByType: { [key: string]: number };
  threatsBySeverity: { [key: string]: number };
  threatsByZone: { [key: string]: number };
  averageConfidence: number;
  responseTime: number; // milliseconds
  falsePositiveRate: number;
  lastThreat: Date | null;
  activeThreats: number;
  resolvedThreats: number;
}

export interface SecurityConfig {
  enabled: boolean;
  realTimeMonitoring: boolean;
  threatDetectionInterval: number; // milliseconds
  maxConcurrentZones: number;
  confidenceThreshold: number; // 0-100
  autoAcknowledge: boolean;
  autoResolve: boolean;
  autoResolveDelay: number; // minutes
  notificationEnabled: boolean;
  recordingEnabled: boolean;
  lockdownEnabled: boolean;
  evacuationEnabled: boolean;
}

@Injectable({
  providedIn: &#x27;root&#x27;
})
export class AiSecurityService {
  private threatsMap: Map&lt;string, SecurityThreat&gt; &#x3D; new Map();
  private rulesMap: Map&lt;string, SecurityRule&gt; &#x3D; new Map();
  private zonesMap: Map&lt;string, SecurityZone&gt; &#x3D; new Map();
  private configData: SecurityConfig &#x3D; this.getDefaultConfig();
  private isMonitoring &#x3D; false;
  private monitoringInterval: any &#x3D; null;

  // ✅ Signals for reactive state
  private _threats &#x3D; signal&lt;SecurityThreat[]&gt;([]);
  private _rules &#x3D; signal&lt;SecurityRule[]&gt;([]);
  private _zones &#x3D; signal&lt;SecurityZone[]&gt;([]);
  private _stats &#x3D; signal&lt;SecurityStats&gt;(this.getInitialStats());
  private _config &#x3D; signal&lt;SecurityConfig&gt;(this.configData);

  // ✅ Readonly signals for public access
  public readonly threats &#x3D; this._threats.asReadonly();
  public readonly rules &#x3D; this._rules.asReadonly();
  public readonly zones &#x3D; this._zones.asReadonly();
  public readonly stats &#x3D; this._stats.asReadonly();
  public readonly config &#x3D; this._config.asReadonly();

  // ✅ Computed signals for derived state
  public readonly threatsCount &#x3D; computed(() &#x3D;&gt; this._threats().length);
  public readonly activeThreatsCount &#x3D; computed(() &#x3D;&gt; this._threats().filter(t &#x3D;&gt; !t.resolved).length);
  public readonly rulesCount &#x3D; computed(() &#x3D;&gt; this._rules().length);
  public readonly zonesCount &#x3D; computed(() &#x3D;&gt; this._zones().length);

  // ✅ Real-time events (keep using Subject - not BehaviorSubject)
  private newThreatSubject &#x3D; new Subject&lt;SecurityThreat&gt;();
  private threatUpdateSubject &#x3D; new Subject&lt;SecurityThreat&gt;();
  private alertSubject &#x3D; new Subject&lt;{ type: string; message: string; data: any }&gt;();
  private lockdownSubject &#x3D; new Subject&lt;{ zoneId: string; reason: string }&gt;();
  private evacuationSubject &#x3D; new Subject&lt;{ zoneId: string; reason: string }&gt;();

  public newThreat$ &#x3D; this.newThreatSubject.asObservable();
  public threatUpdate$ &#x3D; this.threatUpdateSubject.asObservable();
  public alert$ &#x3D; this.alertSubject.asObservable();
  public lockdown$ &#x3D; this.lockdownSubject.asObservable();
  public evacuation$ &#x3D; this.evacuationSubject.asObservable();

  constructor() {
    this.initializeService();
  }

  /**
   * Initialize service
   */
  private initializeService(): void {
    this.loadConfig();
    this.loadRules();
    this.loadZones();
    this.startMonitoring();
  }

  /**
   * Get default configuration
   */
  private getDefaultConfig(): SecurityConfig {
    return {
      enabled: true,
      realTimeMonitoring: true,
      threatDetectionInterval: 200, // 200ms
      maxConcurrentZones: 20,
      confidenceThreshold: 75,
      autoAcknowledge: false,
      autoResolve: false,
      autoResolveDelay: 30, // 30 minutes
      notificationEnabled: true,
      recordingEnabled: true,
      lockdownEnabled: true,
      evacuationEnabled: true
    };
  }

  /**
   * Get initial stats
   */
  private getInitialStats(): SecurityStats {
    return {
      totalThreats: 0,
      threatsByType: {},
      threatsBySeverity: {},
      threatsByZone: {},
      averageConfidence: 0,
      responseTime: 0,
      falsePositiveRate: 0,
      lastThreat: null,
      activeThreats: 0,
      resolvedThreats: 0
    };
  }

  /**
   * Load configuration
   */
  private loadConfig(): void {
    try {
      const stored &#x3D; localStorage.getItem(&#x27;ai_security_config&#x27;);
      if (stored) {
        this.configData &#x3D; { ...this.configData, ...JSON.parse(stored) };
        this._config.set(this.configData);
      }
    } catch (error) {
      console.error(&#x27;Failed to load AI security config:&#x27;, error);
    }
  }

  /**
   * Save configuration
   */
  private saveConfig(): void {
    try {
      localStorage.setItem(&#x27;ai_security_config&#x27;, JSON.stringify(this.configData));
    } catch (error) {
      console.error(&#x27;Failed to save AI security config:&#x27;, error);
    }
  }

  /**
   * Load rules
   */
  private loadRules(): void {
    try {
      const stored &#x3D; localStorage.getItem(&#x27;ai_security_rules&#x27;);
      if (stored) {
        const rules &#x3D; JSON.parse(stored);
        rules.forEach((rule: any) &#x3D;&gt; {
          rule.createdAt &#x3D; new Date(rule.createdAt);
          rule.updatedAt &#x3D; new Date(rule.updatedAt);
      this.rulesMap.set(rule.id, rule);
    });
        this._rules.set(Array.from(this.rulesMap.values()));
      }
    } catch (error) {
      console.error(&#x27;Failed to load AI security rules:&#x27;, error);
    }
  }

  /**
   * Save rules
   */
  private saveRules(): void {
    try {
      const rules &#x3D; Array.from(this.rulesMap.values());
      localStorage.setItem(&#x27;ai_security_rules&#x27;, JSON.stringify(rules));
    } catch (error) {
      console.error(&#x27;Failed to save AI security rules:&#x27;, error);
    }
  }

  /**
   * Load zones
   */
  private loadZones(): void {
    try {
      const stored &#x3D; localStorage.getItem(&#x27;ai_security_zones&#x27;);
      if (stored) {
        const zones &#x3D; JSON.parse(stored);
        zones.forEach((zone: any) &#x3D;&gt; {
          zone.createdAt &#x3D; new Date(zone.createdAt);
          zone.updatedAt &#x3D; new Date(zone.updatedAt);
          this.zonesMap.set(zone.id, zone);
        });
        this._zones.set(Array.from(this.zonesMap.values()));
      }
    } catch (error) {
      console.error(&#x27;Failed to load AI security zones:&#x27;, error);
    }
  }

  /**
   * Save zones
   */
  private saveZones(): void {
    try {
      const zones &#x3D; Array.from(this.zonesMap.values());
      localStorage.setItem(&#x27;ai_security_zones&#x27;, JSON.stringify(zones));
    } catch (error) {
      console.error(&#x27;Failed to save AI security zones:&#x27;, error);
    }
  }

  /**
   * Start monitoring
   */
  private startMonitoring(): void {
    if (this.configData.enabled &amp;&amp; !this.isMonitoring) {
      this.isMonitoring &#x3D; true;
      this.monitoringInterval &#x3D; setInterval(() &#x3D;&gt; {
        this.monitorThreats();
      }, this.configData.threatDetectionInterval);
    }
  }

  /**
   * Stop monitoring
   */
  private stopMonitoring(): void {
    if (this.monitoringInterval) {
      clearInterval(this.monitoringInterval);
      this.monitoringInterval &#x3D; null;
    }
    this.isMonitoring &#x3D; false;
  }

  /**
   * Monitor for threats
   */
  private async monitorThreats(): Promise&lt;void&gt; {
    if (!this.configData.enabled) return;

    const startTime &#x3D; performance.now();
    const activeZones &#x3D; Array.from(this.zonesMap.values()).filter(zone &#x3D;&gt; zone.enabled);

    for (const zone of activeZones) {
      try {
        await this.monitorZone(zone);
      } catch (error) {
        console.error(&#x60;Failed to monitor zone ${zone.id}:&#x60;, error);
      }
    }

    const responseTime &#x3D; performance.now() - startTime;
    this.updateStats({ responseTime });
  }

  /**
   * Monitor individual zone
   */
  private async monitorZone(zone: SecurityZone): Promise&lt;void&gt; {
    // Simulate AI threat detection
    const threats &#x3D; await this.detectThreats(zone);

    for (const threat of threats) {
      await this.processThreat(threat);
    }
  }

  /**
   * Detect threats in zone
   */
  private async detectThreats(zone: SecurityZone): Promise&lt;SecurityThreat[]&gt; {
    const threats: SecurityThreat[] &#x3D; [];
    const zoneRules &#x3D; zone.rules.map(ruleId &#x3D;&gt; this.rulesMap.get(ruleId)).filter(Boolean) as SecurityRule[];

    for (const rule of zoneRules) {
      if (rule.enabled &amp;&amp; Math.random() &lt; rule.sensitivity / 100) {
        const threat: SecurityThreat &#x3D; {
          id: this.generateId(),
          type: rule.type,
          severity: rule.severity,
          confidence: Math.random() * 100,
          location: {
            x: Math.random() * 800,
            y: Math.random() * 600,
            width: 50 + Math.random() * 100,
            height: 50 + Math.random() * 100
          },
          description: this.generateThreatDescription(rule.type),
          metadata: {
            ruleId: rule.id,
            ruleName: rule.name,
            zoneId: zone.id,
            zoneName: zone.name,
            timestamp: new Date().toISOString()
          },
          timestamp: new Date(),
          acknowledged: false,
          resolved: false
        };

        threats.push(threat);
      }
    }

    return threats;
  }

  /**
   * Generate threat description
   */
  private generateThreatDescription(type: string): string {
    const descriptions &#x3D; {
      intrusion: &#x27;Unauthorized access detected&#x27;,
      weapon: &#x27;Weapon detected in restricted area&#x27;,
      violence: &#x27;Violent behavior detected&#x27;,
      suspicious_behavior: &#x27;Suspicious activity observed&#x27;,
      crowd_anomaly: &#x27;Unusual crowd behavior detected&#x27;,
      vehicle_anomaly: &#x27;Suspicious vehicle activity&#x27;,
      fire: &#x27;Fire detected&#x27;,
      smoke: &#x27;Smoke detected&#x27;
    };
    return descriptions[type as keyof typeof descriptions] || &#x27;Security threat detected&#x27;;
  }

  /**
   * Process detected threat
   */
  private async processThreat(threat: SecurityThreat): Promise&lt;void&gt; {
    // Store threat
    this.threatsMap.set(threat.id, threat);
    this._threats.set(Array.from(this.threatsMap.values()));

    // Emit new threat
    this.newThreatSubject.next(threat);

    // Find matching rules
    const rules &#x3D; Array.from(this.rulesMap.values()).filter(rule &#x3D;&gt;
      rule.enabled &amp;&amp; rule.type &#x3D;&#x3D;&#x3D; threat.type
    );

    // Execute rule actions
    for (const rule of rules) {
      if (this.evaluateRule(rule, threat)) {
        await this.executeRuleActions(rule, threat);
      }
    }

    // Auto-acknowledge if enabled
    if (this.configData.autoAcknowledge) {
      this.acknowledgeThreat(threat.id);
    }

    // Auto-resolve if enabled
    if (this.configData.autoResolve) {
      setTimeout(() &#x3D;&gt; {
        this.resolveThreat(threat.id);
      }, this.configData.autoResolveDelay * 60 * 1000);
    }

    // Update stats
    this.updateStats();
  }

  /**
   * Evaluate rule conditions
   */
  private evaluateRule(rule: SecurityRule, threat: SecurityThreat): boolean {
    return threat.confidence &gt;&#x3D; rule.sensitivity;
  }

  /**
   * Execute rule actions
   */
  private async executeRuleActions(rule: SecurityRule, threat: SecurityThreat): Promise&lt;void&gt; {
    for (const action of rule.actions) {
    switch (action.type) {
      case &#x27;alert&#x27;:
          this.alertSubject.next({
            type: &#x27;security_alert&#x27;,
            message: &#x60;Security threat detected: ${threat.description}&#x60;,
            data: { rule, threat }
          });
        break;
      case &#x27;notification&#x27;:
          // Send notification
        break;
        case &#x27;recording&#x27;:
          // Start recording
        break;
        case &#x27;email&#x27;:
          // Send email
        break;
        case &#x27;webhook&#x27;:
          // Send webhook
          break;
        case &#x27;lockdown&#x27;:
          this.lockdownSubject.next({
            zoneId: threat.metadata[&#x27;zoneId&#x27;],
            reason: threat.description
          });
          break;
        case &#x27;evacuation&#x27;:
          this.evacuationSubject.next({
            zoneId: threat.metadata[&#x27;zoneId&#x27;],
            reason: threat.description
          });
        break;
    }
    }
  }

  /**
   * Add security rule
   */
  public addRule(rule: Omit&lt;SecurityRule, &#x27;id&#x27; | &#x27;createdAt&#x27; | &#x27;updatedAt&#x27;&gt;): string {
    const id &#x3D; this.generateId();
    const newRule: SecurityRule &#x3D; {
      ...rule,
      id,
      createdAt: new Date(),
      updatedAt: new Date()
    };

    this.rulesMap.set(id, newRule);
    this._rules.set(Array.from(this.rulesMap.values()));
    this.saveRules();
    return id;
  }

  /**
   * Update rule
   */
  public updateRule(id: string, updates: Partial&lt;SecurityRule&gt;): void {
    const rule &#x3D; this.rulesMap.get(id);
    if (rule) {
      const updatedRule &#x3D; { ...rule, ...updates, updatedAt: new Date() };
      this.rulesMap.set(id, updatedRule);
      this._rules.set(Array.from(this.rulesMap.values()));
      this.saveRules();
    }
  }

  /**
   * Remove rule
   */
  public removeRule(id: string): void {
    this.rulesMap.delete(id);
    this._rules.set(Array.from(this.rulesMap.values()));
    this.saveRules();
  }

  /**
   * Add security zone
   */
  public addZone(zone: Omit&lt;SecurityZone, &#x27;id&#x27; | &#x27;createdAt&#x27; | &#x27;updatedAt&#x27;&gt;): string {
    const id &#x3D; this.generateId();
    const newZone: SecurityZone &#x3D; {
      ...zone,
      id,
      createdAt: new Date(),
      updatedAt: new Date()
    };

    this.zonesMap.set(id, newZone);
    this._zones.set(Array.from(this.zonesMap.values()));
    this.saveZones();
    return id;
  }

  /**
   * Update zone
   */
  public updateZone(id: string, updates: Partial&lt;SecurityZone&gt;): void {
    const zone &#x3D; this.zonesMap.get(id);
    if (zone) {
      const updatedZone &#x3D; { ...zone, ...updates, updatedAt: new Date() };
      this.zonesMap.set(id, updatedZone);
      this._zones.set(Array.from(this.zonesMap.values()));
      this.saveZones();
    }
  }

  /**
   * Remove zone
   */
  public removeZone(id: string): void {
    this.zonesMap.delete(id);
    this._zones.set(Array.from(this.zonesMap.values()));
    this.saveZones();
  }

  /**
   * Acknowledge threat
   */
  public acknowledgeThreat(id: string): void {
    const threat &#x3D; this.threatsMap.get(id);
    if (threat &amp;&amp; !threat.acknowledged) {
      threat.acknowledged &#x3D; true;
      this.threatsMap.set(id, threat);
      this._threats.set(Array.from(this.threatsMap.values()));
      this.threatUpdateSubject.next(threat);
    }
  }

  /**
   * Resolve threat
   */
  public resolveThreat(id: string): void {
    const threat &#x3D; this.threatsMap.get(id);
    if (threat &amp;&amp; !threat.resolved) {
      threat.resolved &#x3D; true;
      this.threatsMap.set(id, threat);
      this._threats.set(Array.from(this.threatsMap.values()));
      this.threatUpdateSubject.next(threat);
    }
  }

  /**
   * Assign threat
   */
  public assignThreat(id: string, assignedTo: string): void {
    const threat &#x3D; this.threatsMap.get(id);
    if (threat) {
      threat.assignedTo &#x3D; assignedTo;
      this.threatsMap.set(id, threat);
      this._threats.set(Array.from(this.threatsMap.values()));
      this.threatUpdateSubject.next(threat);
    }
  }

  /**
   * Add threat notes
   */
  public addThreatNotes(id: string, notes: string): void {
    const threat &#x3D; this.threatsMap.get(id);
    if (threat) {
      threat.notes &#x3D; notes;
      this.threatsMap.set(id, threat);
      this._threats.set(Array.from(this.threatsMap.values()));
      this.threatUpdateSubject.next(threat);
    }
  }

  /**
   * Update configuration
   */
  public updateConfig(updates: Partial&lt;SecurityConfig&gt;): void {
    this.configData &#x3D; { ...this.configData, ...updates };
    this._config.set(this.configData);
    this.saveConfig();

    // Restart monitoring if needed
    if (updates.enabled !&#x3D;&#x3D; undefined) {
      if (updates.enabled) {
        this.startMonitoring();
      } else {
        this.stopMonitoring();
      }
    }
  }

  /**
   * Get threats by type
   */
  public getThreatsByType(type: string): SecurityThreat[] {
    return Array.from(this.threatsMap.values())
      .filter(threat &#x3D;&gt; threat.type &#x3D;&#x3D;&#x3D; type)
      .sort((a, b) &#x3D;&gt; b.timestamp.getTime() - a.timestamp.getTime());
  }

  /**
   * Get threats by severity
   */
  public getThreatsBySeverity(severity: string): SecurityThreat[] {
    return Array.from(this.threatsMap.values())
      .filter(threat &#x3D;&gt; threat.severity &#x3D;&#x3D;&#x3D; severity)
      .sort((a, b) &#x3D;&gt; b.timestamp.getTime() - a.timestamp.getTime());
  }

  /**
   * Get active threats
   */
  public getActiveThreats(): SecurityThreat[] {
    return Array.from(this.threatsMap.values())
      .filter(threat &#x3D;&gt; !threat.resolved)
      .sort((a, b) &#x3D;&gt; b.timestamp.getTime() - a.timestamp.getTime());
  }

  /**
   * Get threats by time range
   */
  public getThreatsByTimeRange(start: Date, end: Date): SecurityThreat[] {
    return Array.from(this.threatsMap.values())
      .filter(threat &#x3D;&gt; threat.timestamp &gt;&#x3D; start &amp;&amp; threat.timestamp &lt;&#x3D; end)
      .sort((a, b) &#x3D;&gt; b.timestamp.getTime() - a.timestamp.getTime());
  }

  /**
   * Clear threats
   */
  public clearThreats(): void {
    this.threatsMap.clear();
    this._threats.set([]);
    this.updateStats();
  }

  /**
   * Update statistics
   */
  private updateStats(updates?: Partial&lt;SecurityStats&gt;): void {
    const currentStats &#x3D; this._stats();
    const threats &#x3D; Array.from(this.threatsMap.values());

    const newStats: SecurityStats &#x3D; {
      totalThreats: threats.length,
      threatsByType: this.groupThreatsByType(threats),
      threatsBySeverity: this.groupThreatsBySeverity(threats),
      threatsByZone: this.groupThreatsByZone(threats),
      averageConfidence: this.calculateAverageConfidence(threats),
      responseTime: updates?.responseTime || currentStats.responseTime,
      falsePositiveRate: this.calculateFalsePositiveRate(),
      lastThreat: threats.length &gt; 0 ? threats[0].timestamp : null,
      activeThreats: threats.filter(t &#x3D;&gt; !t.resolved).length,
      resolvedThreats: threats.filter(t &#x3D;&gt; t.resolved).length
    };

    this._stats.set(newStats);
  }

  /**
   * Group threats by type
   */
  private groupThreatsByType(threats: SecurityThreat[]): { [key: string]: number } {
    return threats.reduce((acc, threat) &#x3D;&gt; {
      acc[threat.type] &#x3D; (acc[threat.type] || 0) + 1;
      return acc;
    }, {} as { [key: string]: number });
  }

  /**
   * Group threats by severity
   */
  private groupThreatsBySeverity(threats: SecurityThreat[]): { [key: string]: number } {
    return threats.reduce((acc, threat) &#x3D;&gt; {
      acc[threat.severity] &#x3D; (acc[threat.severity] || 0) + 1;
      return acc;
    }, {} as { [key: string]: number });
  }

  /**
   * Group threats by zone
   */
  private groupThreatsByZone(threats: SecurityThreat[]): { [key: string]: number } {
    return threats.reduce((acc, threat) &#x3D;&gt; {
      const zoneId &#x3D; threat.metadata[&#x27;zoneId&#x27;];
      if (zoneId) {
        acc[zoneId] &#x3D; (acc[zoneId] || 0) + 1;
      }
      return acc;
    }, {} as { [key: string]: number });
  }

  /**
   * Calculate average confidence
   */
  private calculateAverageConfidence(threats: SecurityThreat[]): number {
    if (threats.length &#x3D;&#x3D;&#x3D; 0) return 0;
    const total &#x3D; threats.reduce((sum, threat) &#x3D;&gt; sum + threat.confidence, 0);
    return total / threats.length;
  }

  /**
   * Calculate false positive rate
   */
  private calculateFalsePositiveRate(): number {
    // Simple false positive rate calculation
    return Math.random() * 10; // 0-10%
  }

  /**
   * Get current configuration
   */
  public getConfig(): SecurityConfig {
    return { ...this.configData };
  }

  /**
   * Get current statistics
   */
  public getStats(): SecurityStats {
    return this._stats();
  }

  /**
   * Check if monitoring is active
   */
  public isMonitoringActive(): boolean {
    return this.isMonitoring;
  }

  /**
   * Generate unique ID
   */
  private generateId(): string {
    return &#x27;sec_&#x27; + Date.now() + &#x27;_&#x27; + Math.random().toString(36).substr(2, 9);
  }

  /**
   * Cleanup resources
   */
  public cleanup(): void {
    this.stopMonitoring();
    this.threatsMap.clear();
    this.rulesMap.clear();
    this.zonesMap.clear();
  }
}
</code></pre>
    </div>
</div>








                   </div><div class="search-results">
    <div class="has-results">
        <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
        <ul class="search-results-list"></ul>
    </div>
    <div class="no-results">
        <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
    </div>
</div>
</div>
               <!-- END CONTENT -->
           </div>
       </div>

          <label class="dark-mode-switch">
               <input type="checkbox">
               <span class="slider">
                    <svg class="slider-icon" viewBox="0 0 24 24" fill="none" height="20" stroke="#000" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" width="20" xmlns="http://www.w3.org/2000/svg">
                    <path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"></path>
                    </svg>
               </span>
          </label>

       <script>
            var COMPODOC_CURRENT_PAGE_DEPTH = 1;
            var COMPODOC_CURRENT_PAGE_CONTEXT = 'interface';
            var COMPODOC_CURRENT_PAGE_URL = 'SecurityZone.html';
            var MAX_SEARCH_RESULTS = 15;
       </script>

       <script>
               $darkModeToggleSwitchers = document.querySelectorAll('.dark-mode-switch input');
               checkToggle(darkModeState);
               if ($darkModeToggleSwitchers.length > 0) {
                    for (var i = 0; i < $darkModeToggleSwitchers.length; i++) {
                         $darkModeToggleSwitchers[i].addEventListener('change', function (event) {
                              darkModeState = !darkModeState;
                              toggleDarkMode(darkModeState);
                         });
                    }
               }
          </script>

       <script src="../js/libs/custom-elements.min.js"></script>
       <script src="../js/libs/lit-html.js"></script>

       <script src="../js/menu-wc.js" defer></script>
       <script nomodule src="../js/menu-wc_es5.js" defer></script>

       <script src="../js/libs/bootstrap-native.js"></script>

       <script src="../js/libs/es6-shim.min.js"></script>
       <script src="../js/libs/EventDispatcher.js"></script>
       <script src="../js/libs/promise.min.js"></script>

       <script src="../js/compodoc.js"></script>

       <script src="../js/tabs.js"></script>
       <script src="../js/menu.js"></script>
       <script src="../js/libs/clipboard.min.js"></script>
       <script src="../js/libs/prism.js"></script>
       <script src="../js/sourceCode.js"></script>
          <script src="../js/search/search.js"></script>
          <script src="../js/search/lunr.min.js"></script>
          <script src="../js/search/search-lunr.js"></script>
          <script src="../js/search/search_index.js"></script>
       <script src="../js/lazy-load-graphs.js"></script>


    </body>
</html>
