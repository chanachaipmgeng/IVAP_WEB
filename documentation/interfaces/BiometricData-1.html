<!doctype html>
<html class="no-js" lang="">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="x-ua-compatible" content="ie=edge">
        <title>frontend documentation</title>
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <link rel="icon" type="image/x-icon" href="../images/favicon.ico">
	   <link rel="stylesheet" href="../styles/style.css">
        <link rel="stylesheet" href="../styles/dark.css">
    </head>
    <body>
          <script>
               // Blocking script to avoid flickering dark mode
               // Dark mode toggle button
               var useDark = window.matchMedia('(prefers-color-scheme: dark)');
               var darkModeState = useDark.matches;
               var $darkModeToggleSwitchers = document.querySelectorAll('.dark-mode-switch input');
               var $darkModeToggles = document.querySelectorAll('.dark-mode-switch');
               var darkModeStateLocal = localStorage.getItem('compodoc_darkmode-state');

               function checkToggle(check) {
                    for (var i = 0; i < $darkModeToggleSwitchers.length; i++) {
                         $darkModeToggleSwitchers[i].checked = check;
                    }
               }

               function toggleDarkMode(state) {
                    if (window.localStorage) {
                         localStorage.setItem('compodoc_darkmode-state', state);
                    }

                    checkToggle(state);

                    const hasClass = document.body.classList.contains('dark');

                    if (state) {
                         for (var i = 0; i < $darkModeToggles.length; i++) {
                              $darkModeToggles[i].classList.add('dark');
                         }
                         if (!hasClass) {
                              document.body.classList.add('dark');
                         }
                    } else {
                         for (var i = 0; i < $darkModeToggles.length; i++) {
                              $darkModeToggles[i].classList.remove('dark');
                         }
                         if (hasClass) {
                              document.body.classList.remove('dark');
                         }
                    }
               }

               useDark.addEventListener('change', function (evt) {
                    toggleDarkMode(evt.matches);
               });
               if (darkModeStateLocal) {
                    darkModeState = darkModeStateLocal === 'true';
               }
               toggleDarkMode(darkModeState);
          </script>
          <script>
              // --- Iframe navigation tracking for Template Playground ---
              function sendCurrentUrlToParent() {
                  if (window.parent && window.parent !== window) {
                      window.parent.postMessage({
                          type: 'compodoc-iframe-navigate',
                          url: window.location.pathname + window.location.hash
                      }, '*');
                  }
              }
              window.addEventListener('hashchange', sendCurrentUrlToParent, false);
              window.addEventListener('popstate', sendCurrentUrlToParent, false);
              window.addEventListener('DOMContentLoaded', sendCurrentUrlToParent, false);
          </script>

        <div class="navbar navbar-default navbar-fixed-top d-md-none p-0">
               <div class="d-flex">
                    <a href="../" class="navbar-brand">frontend documentation</a>
                    <button type="button" class="btn btn-default btn-menu ion-ios-menu" id="btn-menu"></button>
               </div>
        </div>

        <div class="xs-menu menu" id="mobile-menu">
                <div id="book-search-input" role="search"><input type="text" placeholder="Type to search"></div>            <compodoc-menu></compodoc-menu>
        </div>

        <div class="container-fluid main">
           <div class="row main">
               <div class="d-none d-md-block menu">
                   <compodoc-menu mode="normal"></compodoc-menu>
               </div>
               <!-- START CONTENT -->
               <div class="content interface">
                   <div class="content-data">

















<ol class="breadcrumb">
  <li class="breadcrumb-item">Interfaces</li>
  <li class="breadcrumb-item"
  >
  BiometricData</li>
</ol>

<ul class="nav nav-tabs" role="tablist">
        <li class="nav-item">
            <a href="#info" 
                class="nav-link"
                class="nav-link active"
                role="tab" id="info-tab" data-bs-toggle="tab" data-link="info">Info</a>
        </li>
        <li class="nav-item">
            <a href="#source" 
                class="nav-link"
                
                role="tab" id="source-tab" data-bs-toggle="tab" data-link="source">Source</a>
        </li>
</ul>

<div class="tab-content">
    <div class="tab-pane fade active in" id="info">
        <p class="comment">
            <h3>File</h3>
        </p>
        <p class="comment">
            <code>src/app/core/services/multi-factor-verification.service.ts</code>
        </p>




        <section data-compodoc="block-index">
            <h3 id="index">Index</h3>
            <table class="table table-sm table-bordered index-table">
                <tbody>
                    <tr>
                        <td class="col-md-4">
                            <h6><b>Properties</b></h6>
                        </td>
                    </tr>
                    <tr>
                        <td class="col-md-4">
                            <ul class="index-list">
                                <li>
                                        <a href="#enrolledAt" 
>
                                            enrolledAt
                                        </a>
                                </li>
                                <li>
                                        <a href="#id" 
>
                                            id
                                        </a>
                                </li>
                                <li>
                                        <a href="#isActive" 
>
                                            isActive
                                        </a>
                                </li>
                                <li>
                                        <a href="#lastUsed" 
>
                                            lastUsed
                                        </a>
                                </li>
                                <li>
                                        <a href="#quality" 
>
                                            quality
                                        </a>
                                </li>
                                <li>
                                        <a href="#template" 
>
                                            template
                                        </a>
                                </li>
                                <li>
                                        <a href="#type" 
>
                                            type
                                        </a>
                                </li>
                                <li>
                                        <a href="#userId" 
>
                                            userId
                                        </a>
                                </li>
                            </ul>
                        </td>
                    </tr>
                </tbody>
            </table>
        </section>



            <section data-compodoc="block-properties">
                <h3 id="inputs">Properties</h3>
                    <table class="table table-sm table-bordered">
                        <tbody>
                                <tr>
                                    <td class="col-md-4">
                                        <a name="enrolledAt"></a>
                                        <span class="name "><b>enrolledAt</b>
                                            <a href="#enrolledAt">
                                                <span class="icon ion-ios-link"></span>
                                            </a>
                                        </span>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="col-md-4">
                                        <code>enrolledAt:         <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Date" target="_blank" >Date</a></code>
</code>
                                    </td>
                                </tr>


                                    <tr>
                                        <td class="col-md-4">
                                            <i>Type : </i>        <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Date" target="_blank" >Date</a></code>

                                        </td>
                                    </tr>





                        </tbody>
                    </table>
                    <table class="table table-sm table-bordered">
                        <tbody>
                                <tr>
                                    <td class="col-md-4">
                                        <a name="id"></a>
                                        <span class="name "><b>id</b>
                                            <a href="#id">
                                                <span class="icon ion-ios-link"></span>
                                            </a>
                                        </span>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="col-md-4">
                                        <code>id:         <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>
</code>
                                    </td>
                                </tr>


                                    <tr>
                                        <td class="col-md-4">
                                            <i>Type : </i>        <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>

                                        </td>
                                    </tr>





                        </tbody>
                    </table>
                    <table class="table table-sm table-bordered">
                        <tbody>
                                <tr>
                                    <td class="col-md-4">
                                        <a name="isActive"></a>
                                        <span class="name "><b>isActive</b>
                                            <a href="#isActive">
                                                <span class="icon ion-ios-link"></span>
                                            </a>
                                        </span>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="col-md-4">
                                        <code>isActive:         <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/boolean" target="_blank" >boolean</a></code>
</code>
                                    </td>
                                </tr>


                                    <tr>
                                        <td class="col-md-4">
                                            <i>Type : </i>        <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/boolean" target="_blank" >boolean</a></code>

                                        </td>
                                    </tr>





                        </tbody>
                    </table>
                    <table class="table table-sm table-bordered">
                        <tbody>
                                <tr>
                                    <td class="col-md-4">
                                        <a name="lastUsed"></a>
                                        <span class="name "><b>lastUsed</b>
                                            <a href="#lastUsed">
                                                <span class="icon ion-ios-link"></span>
                                            </a>
                                        </span>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="col-md-4">
                                        <code>lastUsed:         <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Date" target="_blank" >Date</a></code>
</code>
                                    </td>
                                </tr>


                                    <tr>
                                        <td class="col-md-4">
                                            <i>Type : </i>        <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Date" target="_blank" >Date</a></code>

                                        </td>
                                    </tr>





                        </tbody>
                    </table>
                    <table class="table table-sm table-bordered">
                        <tbody>
                                <tr>
                                    <td class="col-md-4">
                                        <a name="quality"></a>
                                        <span class="name "><b>quality</b>
                                            <a href="#quality">
                                                <span class="icon ion-ios-link"></span>
                                            </a>
                                        </span>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="col-md-4">
                                        <code>quality:         <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/number" target="_blank" >number</a></code>
</code>
                                    </td>
                                </tr>


                                    <tr>
                                        <td class="col-md-4">
                                            <i>Type : </i>        <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/number" target="_blank" >number</a></code>

                                        </td>
                                    </tr>





                        </tbody>
                    </table>
                    <table class="table table-sm table-bordered">
                        <tbody>
                                <tr>
                                    <td class="col-md-4">
                                        <a name="template"></a>
                                        <span class="name "><b>template</b>
                                            <a href="#template">
                                                <span class="icon ion-ios-link"></span>
                                            </a>
                                        </span>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="col-md-4">
                                        <code>template:         <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>
</code>
                                    </td>
                                </tr>


                                    <tr>
                                        <td class="col-md-4">
                                            <i>Type : </i>        <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>

                                        </td>
                                    </tr>





                        </tbody>
                    </table>
                    <table class="table table-sm table-bordered">
                        <tbody>
                                <tr>
                                    <td class="col-md-4">
                                        <a name="type"></a>
                                        <span class="name "><b>type</b>
                                            <a href="#type">
                                                <span class="icon ion-ios-link"></span>
                                            </a>
                                        </span>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="col-md-4">
                                        <code>type:     <code>&quot;fingerprint&quot; | &quot;face&quot; | &quot;voice&quot; | &quot;iris&quot; | &quot;palm&quot;</code>
</code>
                                    </td>
                                </tr>


                                    <tr>
                                        <td class="col-md-4">
                                            <i>Type : </i>    <code>&quot;fingerprint&quot; | &quot;face&quot; | &quot;voice&quot; | &quot;iris&quot; | &quot;palm&quot;</code>

                                        </td>
                                    </tr>





                        </tbody>
                    </table>
                    <table class="table table-sm table-bordered">
                        <tbody>
                                <tr>
                                    <td class="col-md-4">
                                        <a name="userId"></a>
                                        <span class="name "><b>userId</b>
                                            <a href="#userId">
                                                <span class="icon ion-ios-link"></span>
                                            </a>
                                        </span>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="col-md-4">
                                        <code>userId:         <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>
</code>
                                    </td>
                                </tr>


                                    <tr>
                                        <td class="col-md-4">
                                            <i>Type : </i>        <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>

                                        </td>
                                    </tr>





                        </tbody>
                    </table>
            </section>
    </div>


    <div class="tab-pane fade  tab-source-code" id="source">
        <pre class="line-numbers compodoc-sourcecode"><code class="language-typescript">import { Injectable, inject, signal, computed } from &#x27;@angular/core&#x27;;
import { Observable, throwError, timer, of } from &#x27;rxjs&#x27;;
import { map, catchError, retry, tap } from &#x27;rxjs/operators&#x27;;
import { ApiService } from &#x27;./api.service&#x27;;

export interface VerificationMethod {
  id: string;
  type: &#x27;sms&#x27; | &#x27;email&#x27; | &#x27;totp&#x27; | &#x27;push&#x27; | &#x27;biometric&#x27; | &#x27;hardware_token&#x27;;
  name: string;
  enabled: boolean;
  priority: number;
  icon: string;
  description: string;
  requiresSetup: boolean;
  isSetup: boolean;
}

export interface VerificationCode {
  id: string;
  method: string;
  code: string;
  expiresAt: Date;
  attempts: number;
  maxAttempts: number;
  used: boolean;
  createdAt: Date;
}

export interface VerificationSession {
  id: string;
  userId: string;
  sessionId: string;
  methods: VerificationMethod[];
  completedMethods: string[];
  requiredMethods: string[];
  status: &#x27;pending&#x27; | &#x27;in_progress&#x27; | &#x27;completed&#x27; | &#x27;failed&#x27; | &#x27;expired&#x27;;
  createdAt: Date;
  expiresAt: Date;
  lastActivity: Date;
  metadata: Record&lt;string, any&gt;;
}

export interface BiometricData {
  id: string;
  userId: string;
  type: &#x27;fingerprint&#x27; | &#x27;face&#x27; | &#x27;voice&#x27; | &#x27;iris&#x27; | &#x27;palm&#x27;;
  template: string;
  quality: number;
  enrolledAt: Date;
  lastUsed: Date;
  isActive: boolean;
}

export interface HardwareToken {
  id: string;
  userId: string;
  serialNumber: string;
  type: &#x27;yubikey&#x27; | &#x27;fido2&#x27; | &#x27;u2f&#x27; | &#x27;totp_hardware&#x27;;
  name: string;
  registeredAt: Date;
  lastUsed: Date;
  isActive: boolean;
  publicKey?: string;
  attestation?: string;
}

export interface PushNotification {
  id: string;
  userId: string;
  deviceId: string;
  deviceName: string;
  platform: &#x27;ios&#x27; | &#x27;android&#x27; | &#x27;web&#x27;;
  token: string;
  registeredAt: Date;
  lastUsed: Date;
  isActive: boolean;
}

@Injectable({
  providedIn: &#x27;root&#x27;
})
export class MultiFactorVerificationService {
  private api &#x3D; inject(ApiService);

  // ‚úÖ Signals for reactive state
  private _verificationMethods &#x3D; signal&lt;VerificationMethod[]&gt;([]);
  private _activeSession &#x3D; signal&lt;VerificationSession | null&gt;(null);
  private _biometricData &#x3D; signal&lt;BiometricData[]&gt;([]);
  private _hardwareTokens &#x3D; signal&lt;HardwareToken[]&gt;([]);
  private _pushNotifications &#x3D; signal&lt;PushNotification[]&gt;([]);

  // ‚úÖ Readonly signals for public access
  public readonly verificationMethods &#x3D; this._verificationMethods.asReadonly();
  public readonly activeSession &#x3D; this._activeSession.asReadonly();
  public readonly biometricData &#x3D; this._biometricData.asReadonly();
  public readonly hardwareTokens &#x3D; this._hardwareTokens.asReadonly();
  public readonly pushNotifications &#x3D; this._pushNotifications.asReadonly();

  // ‚úÖ Computed signals for derived state
  public readonly verificationMethodsCount &#x3D; computed(() &#x3D;&gt; this._verificationMethods().length);
  public readonly enabledMethodsCount &#x3D; computed(() &#x3D;&gt;
    this._verificationMethods().filter(m &#x3D;&gt; m.enabled).length
  );
  public readonly biometricDataCount &#x3D; computed(() &#x3D;&gt; this._biometricData().length);
  public readonly activeBiometricDataCount &#x3D; computed(() &#x3D;&gt;
    this._biometricData().filter(b &#x3D;&gt; b.isActive).length
  );
  public readonly hardwareTokensCount &#x3D; computed(() &#x3D;&gt; this._hardwareTokens().length);
  public readonly activeHardwareTokensCount &#x3D; computed(() &#x3D;&gt;
    this._hardwareTokens().filter(t &#x3D;&gt; t.isActive).length
  );
  public readonly pushNotificationsCount &#x3D; computed(() &#x3D;&gt; this._pushNotifications().length);
  public readonly activePushNotificationsCount &#x3D; computed(() &#x3D;&gt;
    this._pushNotifications().filter(p &#x3D;&gt; p.isActive).length
  );
  public readonly hasActiveSession &#x3D; computed(() &#x3D;&gt; this._activeSession() !&#x3D;&#x3D; null);
  public readonly isSessionCompleted &#x3D; computed(() &#x3D;&gt;
    this._activeSession()?.status &#x3D;&#x3D;&#x3D; &#x27;completed&#x27;
  );

  // ‚úÖ Observable compatibility layer (for backward compatibility)
  getVerificationMethods$(): Observable&lt;VerificationMethod[]&gt; {
    return new Observable&lt;VerificationMethod[]&gt;(observer &#x3D;&gt; {
      observer.next(this._verificationMethods());
      // Note: This is a compatibility layer - prefer using signals directly
    });
  }
  getActiveSession$(): Observable&lt;VerificationSession | null&gt; {
    return new Observable&lt;VerificationSession | null&gt;(observer &#x3D;&gt; {
      observer.next(this._activeSession());
      // Note: This is a compatibility layer - prefer using signals directly
    });
  }

  constructor() {
    this.initializeVerificationMethods();
  }

  private initializeVerificationMethods(): void {
    const methods: VerificationMethod[] &#x3D; [
      {
        id: &#x27;sms&#x27;,
        type: &#x27;sms&#x27;,
        name: &#x27;SMS Code&#x27;,
        enabled: true,
        priority: 1,
        icon: &#x27;üì±&#x27;,
        description: &#x27;Receive verification code via SMS&#x27;,
        requiresSetup: true,
        isSetup: true
      },
      {
        id: &#x27;email&#x27;,
        type: &#x27;email&#x27;,
        name: &#x27;Email Code&#x27;,
        enabled: true,
        priority: 2,
        icon: &#x27;üìß&#x27;,
        description: &#x27;Receive verification code via email&#x27;,
        requiresSetup: true,
        isSetup: true
      },
      {
        id: &#x27;totp&#x27;,
        type: &#x27;totp&#x27;,
        name: &#x27;Authenticator App&#x27;,
        enabled: true,
        priority: 3,
        icon: &#x27;üîê&#x27;,
        description: &#x27;Use authenticator app for time-based codes&#x27;,
        requiresSetup: true,
        isSetup: false
      },
      {
        id: &#x27;push&#x27;,
        type: &#x27;push&#x27;,
        name: &#x27;Push Notification&#x27;,
        enabled: true,
        priority: 4,
        icon: &#x27;üîî&#x27;,
        description: &#x27;Approve via push notification&#x27;,
        requiresSetup: true,
        isSetup: false
      },
      {
        id: &#x27;biometric&#x27;,
        type: &#x27;biometric&#x27;,
        name: &#x27;Biometric&#x27;,
        enabled: true,
        priority: 5,
        icon: &#x27;üëÜ&#x27;,
        description: &#x27;Use fingerprint or face recognition&#x27;,
        requiresSetup: true,
        isSetup: false
      },
      {
        id: &#x27;hardware_token&#x27;,
        type: &#x27;hardware_token&#x27;,
        name: &#x27;Hardware Token&#x27;,
        enabled: true,
        priority: 6,
        icon: &#x27;üîë&#x27;,
        description: &#x27;Use hardware security key&#x27;,
        requiresSetup: true,
        isSetup: false
      }
    ];

    this._verificationMethods.set(methods);
  }

  // Verification Methods Management
  getVerificationMethods(): Observable&lt;VerificationMethod[]&gt; {
    return this.getVerificationMethods$();
  }

  updateVerificationMethod(methodId: string, updates: Partial&lt;VerificationMethod&gt;): Observable&lt;boolean&gt; {
    const methods &#x3D; this._verificationMethods();
    const index &#x3D; methods.findIndex(method &#x3D;&gt; method.id &#x3D;&#x3D;&#x3D; methodId);

    if (index &#x3D;&#x3D;&#x3D; -1) {
      return throwError(() &#x3D;&gt; new Error(&#x27;Verification method not found&#x27;));
    }

    methods[index] &#x3D; { ...methods[index], ...updates };
    this._verificationMethods.set([...methods]);

    return new Observable(observer &#x3D;&gt; {
      observer.next(true);
      observer.complete();
    });
  }

  // Verification Session Management
  createVerificationSession(userId: string, requiredMethods: string[]): Observable&lt;VerificationSession&gt; {
    const methods &#x3D; this._verificationMethods().filter((method: VerificationMethod) &#x3D;&gt;
      requiredMethods.includes(method.id) &amp;&amp; method.enabled
    );

    const session: VerificationSession &#x3D; {
      id: this.generateId(),
      userId,
      sessionId: this.generateSessionId(),
      methods,
      completedMethods: [],
      requiredMethods,
      status: &#x27;pending&#x27;,
      createdAt: new Date(),
      expiresAt: new Date(Date.now() + 10 * 60 * 1000), // 10 minutes
      lastActivity: new Date(),
      metadata: {}
    };

    this._activeSession.set(session);

    return new Observable(observer &#x3D;&gt; {
      observer.next(session);
      observer.complete();
    });
  }

  getActiveSession(): Observable&lt;VerificationSession | null&gt; {
    return this.getActiveSession$();
  }

  // SMS Verification
  sendSMSVerification(memberId: string, companyId: string, phoneNumber: string): Observable&lt;any&gt; {
    // Backend: POST /api/v1/mfa/send/sms?member_id&#x3D;{member_id}&amp;company_id&#x3D;{company_id}&amp;phone_number&#x3D;{phone_number}
    return this.api.post&lt;any&gt;(&#x27;/mfa/send/sms&#x27;, {}, {
      member_id: memberId,
      company_id: companyId,
      phone_number: phoneNumber
    });
  }

  verifySMSCode(verificationRequest: any): Observable&lt;boolean&gt; {
    // Backend: POST /api/v1/mfa/verify
    return this.api.post&lt;{ valid: boolean; verified?: boolean }&gt;(&#x27;/mfa/verify&#x27;, verificationRequest).pipe(
      map((response: any) &#x3D;&gt; {
        const isValid &#x3D; response.valid || response.verified || false;
        if (isValid) {
          this.completeVerificationMethod(&#x27;sms&#x27;);
        }
        return isValid;
      }),
      catchError((error) &#x3D;&gt; {
        console.error(&#x27;Error verifying SMS code:&#x27;, error);
        throw error;
      })
    );
  }

  // Email Verification
  sendEmailVerification(memberId: string, companyId: string, email: string): Observable&lt;any&gt; {
    // Backend: POST /api/v1/mfa/send/email?member_id&#x3D;{member_id}&amp;company_id&#x3D;{company_id}&amp;email&#x3D;{email}
    return this.api.post&lt;any&gt;(&#x27;/mfa/send/email&#x27;, {}, {
      member_id: memberId,
      company_id: companyId,
      email: email
    });
  }

  verifyEmailCode(verificationRequest: any): Observable&lt;boolean&gt; {
    // Backend: POST /api/v1/mfa/verify
    return this.api.post&lt;{ valid: boolean; verified?: boolean }&gt;(&#x27;/mfa/verify&#x27;, verificationRequest).pipe(
      map((response: any) &#x3D;&gt; {
        const isValid &#x3D; response.valid || response.verified || false;
        if (isValid) {
          this.completeVerificationMethod(&#x27;email&#x27;);
        }
        return isValid;
      }),
      catchError((error) &#x3D;&gt; {
        console.error(&#x27;Error verifying email code:&#x27;, error);
        throw error;
      })
    );
  }

  // MFA Config Management
  createMfaConfig(configData: any): Observable&lt;any&gt; {
    // Backend: POST /api/v1/mfa/config
    return this.api.post&lt;any&gt;(&#x27;/mfa/config&#x27;, configData);
  }

  getMfaConfig(): Observable&lt;any&gt; {
    // Backend: GET /api/v1/mfa/config
    return this.api.get&lt;any&gt;(&#x27;/mfa/config&#x27;);
  }

  getMfaConfigByMemberId(memberId: string, companyId: string): Observable&lt;any&gt; {
    // Backend: GET /api/v1/mfa/config/{member_id}?company_id&#x3D;{company_id}
    return this.api.get&lt;any&gt;(&#x60;/mfa/config/${memberId}&#x60;, { company_id: companyId });
  }

  updateMfaConfig(memberId: string, companyId: string, updateData: any): Observable&lt;any&gt; {
    // Backend: PUT /api/v1/mfa/config/{member_id}?company_id&#x3D;{company_id}
    return this.api.put&lt;any&gt;(&#x60;/mfa/config/${memberId}&#x60;, updateData, { company_id: companyId });
  }

  deleteMfaConfig(memberId: string, companyId: string): Observable&lt;any&gt; {
    // Backend: DELETE /api/v1/mfa/config/{member_id}?company_id&#x3D;{company_id}
    return this.api.delete&lt;any&gt;(&#x60;/mfa/config/${memberId}&#x60;, { company_id: companyId });
  }

  // TOTP (Time-based One-Time Password)
  generateTOTPSecret(setupData?: any): Observable&lt;{ secret: string; qrCode: string }&gt; {
    // Backend: POST /api/v1/mfa/setup/totp
    return this.api.post&lt;{ secret: string; qrCode: string; qr_code?: string }&gt;(&#x27;/mfa/setup/totp&#x27;, setupData || {}).pipe(
      map((response: any) &#x3D;&gt; ({
        secret: response.secret || response.data?.secret || &#x27;&#x27;,
        qrCode: response.qrCode || response.qr_code || response.data?.qr_code || &#x27;&#x27;
      })),
      catchError((error) &#x3D;&gt; {
        console.error(&#x27;Error generating TOTP secret:&#x27;, error);
        throw error;
      })
    );
  }

  verifyTOTPCode(verificationRequest: any): Observable&lt;boolean&gt; {
    // Backend: POST /api/v1/mfa/verify
    return this.api.post&lt;{ valid: boolean; verified?: boolean }&gt;(&#x27;/mfa/verify&#x27;, verificationRequest).pipe(
      map((response: any) &#x3D;&gt; {
        const isValid &#x3D; response.valid || response.verified || false;
        if (isValid) {
          this.completeVerificationMethod(&#x27;totp&#x27;);
        }
        return isValid;
      }),
      catchError((error) &#x3D;&gt; {
        console.error(&#x27;Error verifying TOTP code:&#x27;, error);
        throw error;
      })
    );
  }

  // Push Notification Verification
  sendPushVerification(deviceId: string): Observable&lt;boolean&gt; {
    return new Observable(observer &#x3D;&gt; {
      // Simulate push notification sending
      timer(1000).subscribe(() &#x3D;&gt; {
        // Push notification sent
        observer.next(true);
        observer.complete();
      });
    });
  }

  approvePushVerification(deviceId: string, approved: boolean): Observable&lt;boolean&gt; {
    return new Observable(observer &#x3D;&gt; {
      if (approved) {
        this.completeVerificationMethod(&#x27;push&#x27;);
      }

      observer.next(approved);
      observer.complete();
    });
  }

  // Biometric Verification
  enrollBiometric(userId: string, type: BiometricData[&#x27;type&#x27;], template: string): Observable&lt;BiometricData&gt; {
    const biometric: BiometricData &#x3D; {
      id: this.generateId(),
      userId,
      type,
      template,
      quality: Math.floor(Math.random() * 40) + 60, // 60-100
      enrolledAt: new Date(),
      lastUsed: new Date(),
      isActive: true
    };

    const biometrics &#x3D; this._biometricData();
    this._biometricData.set([...biometrics, biometric]);

    return new Observable(observer &#x3D;&gt; {
      observer.next(biometric);
      observer.complete();
    });
  }

  verifyBiometric(userId: string, type: BiometricData[&#x27;type&#x27;], template: string): Observable&lt;boolean&gt; {
    return new Observable(observer &#x3D;&gt; {
      const biometrics &#x3D; this._biometricData();
      const userBiometric &#x3D; biometrics.find(b &#x3D;&gt;
        b.userId &#x3D;&#x3D;&#x3D; userId &amp;&amp; b.type &#x3D;&#x3D;&#x3D; type &amp;&amp; b.isActive
      );

      if (userBiometric) {
        // Simulate biometric verification
        const isMatch &#x3D; this.simulateBiometricMatch(template, userBiometric.template);

        if (isMatch) {
          userBiometric.lastUsed &#x3D; new Date();
          this._biometricData.set([...biometrics]);
          this.completeVerificationMethod(&#x27;biometric&#x27;);
        }

        observer.next(isMatch);
      } else {
        observer.next(false);
      }

      observer.complete();
    });
  }

  // Hardware Token Verification
  registerHardwareToken(userId: string, token: Omit&lt;HardwareToken, &#x27;id&#x27; | &#x27;registeredAt&#x27; | &#x27;lastUsed&#x27;&gt;): Observable&lt;HardwareToken&gt; {
    const hardwareToken: HardwareToken &#x3D; {
      ...token,
      id: this.generateId(),
      registeredAt: new Date(),
      lastUsed: new Date()
    };

    const tokens &#x3D; this._hardwareTokens();
    this._hardwareTokens.set([...tokens, hardwareToken]);

    return new Observable(observer &#x3D;&gt; {
      observer.next(hardwareToken);
      observer.complete();
    });
  }

  verifyHardwareToken(userId: string, challenge: string, response: string): Observable&lt;boolean&gt; {
    return new Observable(observer &#x3D;&gt; {
      const tokens &#x3D; this._hardwareTokens();
      const userToken &#x3D; tokens.find(t &#x3D;&gt; t.userId &#x3D;&#x3D;&#x3D; userId &amp;&amp; t.isActive);

      if (userToken) {
        // Simulate hardware token verification
        const isValid &#x3D; this.simulateHardwareTokenVerification(challenge, response);

        if (isValid) {
          userToken.lastUsed &#x3D; new Date();
          this._hardwareTokens.set([...tokens]);
          this.completeVerificationMethod(&#x27;hardware_token&#x27;);
        }

        observer.next(isValid);
      } else {
        observer.next(false);
      }

      observer.complete();
    });
  }

  // Session Management
  completeVerificationMethod(methodId: string): void {
    const session &#x3D; this._activeSession();
    if (session &amp;&amp; !session.completedMethods.includes(methodId)) {
      session.completedMethods.push(methodId);
      session.lastActivity &#x3D; new Date();

      // Check if all required methods are completed
      const allRequiredCompleted &#x3D; session.requiredMethods.every(method &#x3D;&gt;
        session.completedMethods.includes(method)
      );

      if (allRequiredCompleted) {
        session.status &#x3D; &#x27;completed&#x27;;
      } else {
        session.status &#x3D; &#x27;in_progress&#x27;;
      }

      this._activeSession.set({ ...session });
    }
  }

  isVerificationComplete(): Observable&lt;boolean&gt; {
    return new Observable&lt;boolean&gt;(observer &#x3D;&gt; {
      const session &#x3D; this._activeSession();
      if (!session) {
        observer.next(false);
        observer.complete();
        return;
      }
      const isComplete &#x3D; session.requiredMethods.every((method: string) &#x3D;&gt;
        session.completedMethods.includes(method)
      );
      observer.next(isComplete);
      observer.complete();
    });
  }

  getVerificationProgress(): Observable&lt;{ completed: number; total: number; percentage: number }&gt; {
    return new Observable&lt;{ completed: number; total: number; percentage: number }&gt;(observer &#x3D;&gt; {
      const session &#x3D; this._activeSession();
      if (!session) {
        observer.next({ completed: 0, total: 0, percentage: 0 });
        observer.complete();
        return;
      }

      const completed &#x3D; session.completedMethods.length;
      const total &#x3D; session.requiredMethods.length;
      const percentage &#x3D; total &gt; 0 ? Math.round((completed / total) * 100) : 0;

      observer.next({ completed, total, percentage });
      observer.complete();
    });
  }

  clearVerificationSession(): void {
    this._activeSession.set(null);
  }

  // Backup Codes
  generateBackupCodes(request: any): Observable&lt;any&gt; {
    // Backend: POST /api/v1/mfa/backup-codes/generate
    return this.api.post&lt;any&gt;(&#x27;/mfa/backup-codes/generate&#x27;, request);
  }

  // MFA Status
  getMfaStatus(memberId: string, companyId: string): Observable&lt;any&gt; {
    // Backend: GET /api/v1/mfa/status/{member_id}?company_id&#x3D;{company_id}
    return this.api.get&lt;any&gt;(&#x60;/mfa/status/${memberId}&#x60;, { company_id: companyId });
  }

  // Device Trust
  trustDevice(request: any): Observable&lt;any&gt; {
    // Backend: POST /api/v1/mfa/device/trust
    return this.api.post&lt;any&gt;(&#x27;/mfa/device/trust&#x27;, request);
  }

  // Utility Methods
  private generateId(): string {
    return &#x27;mfa-&#x27; + Math.random().toString(36).substr(2, 9);
  }

  private generateSessionId(): string {
    return &#x27;session-&#x27; + Math.random().toString(36).substr(2, 12);
  }

  private generateCode(length: number): string {
    const chars &#x3D; &#x27;0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ&#x27;;
    let result &#x3D; &#x27;&#x27;;
    for (let i &#x3D; 0; i &lt; length; i++) {
      result +&#x3D; chars.charAt(Math.floor(Math.random() * chars.length));
    }
    return result;
  }

  private generateSecret(length: number): string {
    const chars &#x3D; &#x27;ABCDEFGHIJKLMNOPQRSTUVWXYZ234567&#x27;;
    let result &#x3D; &#x27;&#x27;;
    for (let i &#x3D; 0; i &lt; length; i++) {
      result +&#x3D; chars.charAt(Math.floor(Math.random() * chars.length));
    }
    return result;
  }

  private simulateBiometricMatch(template1: string, template2: string): boolean {
    // Simulate biometric matching with 95% success rate
    return Math.random() &lt; 0.95;
  }

  private simulateHardwareTokenVerification(challenge: string, response: string): boolean {
    // Simulate hardware token verification with 98% success rate
    return Math.random() &lt; 0.98;
  }
}

</code></pre>
    </div>
</div>








                   </div><div class="search-results">
    <div class="has-results">
        <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
        <ul class="search-results-list"></ul>
    </div>
    <div class="no-results">
        <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
    </div>
</div>
</div>
               <!-- END CONTENT -->
           </div>
       </div>

          <label class="dark-mode-switch">
               <input type="checkbox">
               <span class="slider">
                    <svg class="slider-icon" viewBox="0 0 24 24" fill="none" height="20" stroke="#000" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" width="20" xmlns="http://www.w3.org/2000/svg">
                    <path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"></path>
                    </svg>
               </span>
          </label>

       <script>
            var COMPODOC_CURRENT_PAGE_DEPTH = 1;
            var COMPODOC_CURRENT_PAGE_CONTEXT = 'interface';
            var COMPODOC_CURRENT_PAGE_URL = 'BiometricData-1.html';
            var MAX_SEARCH_RESULTS = 15;
       </script>

       <script>
               $darkModeToggleSwitchers = document.querySelectorAll('.dark-mode-switch input');
               checkToggle(darkModeState);
               if ($darkModeToggleSwitchers.length > 0) {
                    for (var i = 0; i < $darkModeToggleSwitchers.length; i++) {
                         $darkModeToggleSwitchers[i].addEventListener('change', function (event) {
                              darkModeState = !darkModeState;
                              toggleDarkMode(darkModeState);
                         });
                    }
               }
          </script>

       <script src="../js/libs/custom-elements.min.js"></script>
       <script src="../js/libs/lit-html.js"></script>

       <script src="../js/menu-wc.js" defer></script>
       <script nomodule src="../js/menu-wc_es5.js" defer></script>

       <script src="../js/libs/bootstrap-native.js"></script>

       <script src="../js/libs/es6-shim.min.js"></script>
       <script src="../js/libs/EventDispatcher.js"></script>
       <script src="../js/libs/promise.min.js"></script>

       <script src="../js/compodoc.js"></script>

       <script src="../js/tabs.js"></script>
       <script src="../js/menu.js"></script>
       <script src="../js/libs/clipboard.min.js"></script>
       <script src="../js/libs/prism.js"></script>
       <script src="../js/sourceCode.js"></script>
          <script src="../js/search/search.js"></script>
          <script src="../js/search/lunr.min.js"></script>
          <script src="../js/search/search-lunr.js"></script>
          <script src="../js/search/search_index.js"></script>
       <script src="../js/lazy-load-graphs.js"></script>


    </body>
</html>
