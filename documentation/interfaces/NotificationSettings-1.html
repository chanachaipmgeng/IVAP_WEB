<!doctype html>
<html class="no-js" lang="">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="x-ua-compatible" content="ie=edge">
        <title>frontend documentation</title>
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <link rel="icon" type="image/x-icon" href="../images/favicon.ico">
	   <link rel="stylesheet" href="../styles/style.css">
        <link rel="stylesheet" href="../styles/dark.css">
    </head>
    <body>
          <script>
               // Blocking script to avoid flickering dark mode
               // Dark mode toggle button
               var useDark = window.matchMedia('(prefers-color-scheme: dark)');
               var darkModeState = useDark.matches;
               var $darkModeToggleSwitchers = document.querySelectorAll('.dark-mode-switch input');
               var $darkModeToggles = document.querySelectorAll('.dark-mode-switch');
               var darkModeStateLocal = localStorage.getItem('compodoc_darkmode-state');

               function checkToggle(check) {
                    for (var i = 0; i < $darkModeToggleSwitchers.length; i++) {
                         $darkModeToggleSwitchers[i].checked = check;
                    }
               }

               function toggleDarkMode(state) {
                    if (window.localStorage) {
                         localStorage.setItem('compodoc_darkmode-state', state);
                    }

                    checkToggle(state);

                    const hasClass = document.body.classList.contains('dark');

                    if (state) {
                         for (var i = 0; i < $darkModeToggles.length; i++) {
                              $darkModeToggles[i].classList.add('dark');
                         }
                         if (!hasClass) {
                              document.body.classList.add('dark');
                         }
                    } else {
                         for (var i = 0; i < $darkModeToggles.length; i++) {
                              $darkModeToggles[i].classList.remove('dark');
                         }
                         if (hasClass) {
                              document.body.classList.remove('dark');
                         }
                    }
               }

               useDark.addEventListener('change', function (evt) {
                    toggleDarkMode(evt.matches);
               });
               if (darkModeStateLocal) {
                    darkModeState = darkModeStateLocal === 'true';
               }
               toggleDarkMode(darkModeState);
          </script>
          <script>
              // --- Iframe navigation tracking for Template Playground ---
              function sendCurrentUrlToParent() {
                  if (window.parent && window.parent !== window) {
                      window.parent.postMessage({
                          type: 'compodoc-iframe-navigate',
                          url: window.location.pathname + window.location.hash
                      }, '*');
                  }
              }
              window.addEventListener('hashchange', sendCurrentUrlToParent, false);
              window.addEventListener('popstate', sendCurrentUrlToParent, false);
              window.addEventListener('DOMContentLoaded', sendCurrentUrlToParent, false);
          </script>

        <div class="navbar navbar-default navbar-fixed-top d-md-none p-0">
               <div class="d-flex">
                    <a href="../" class="navbar-brand">frontend documentation</a>
                    <button type="button" class="btn btn-default btn-menu ion-ios-menu" id="btn-menu"></button>
               </div>
        </div>

        <div class="xs-menu menu" id="mobile-menu">
                <div id="book-search-input" role="search"><input type="text" placeholder="Type to search"></div>            <compodoc-menu></compodoc-menu>
        </div>

        <div class="container-fluid main">
           <div class="row main">
               <div class="d-none d-md-block menu">
                   <compodoc-menu mode="normal"></compodoc-menu>
               </div>
               <!-- START CONTENT -->
               <div class="content interface">
                   <div class="content-data">

















<ol class="breadcrumb">
  <li class="breadcrumb-item">Interfaces</li>
  <li class="breadcrumb-item"
  >
  NotificationSettings</li>
</ol>

<ul class="nav nav-tabs" role="tablist">
        <li class="nav-item">
            <a href="#info" 
                class="nav-link"
                class="nav-link active"
                role="tab" id="info-tab" data-bs-toggle="tab" data-link="info">Info</a>
        </li>
        <li class="nav-item">
            <a href="#source" 
                class="nav-link"
                
                role="tab" id="source-tab" data-bs-toggle="tab" data-link="source">Source</a>
        </li>
</ul>

<div class="tab-content">
    <div class="tab-pane fade active in" id="info">
        <p class="comment">
            <h3>File</h3>
        </p>
        <p class="comment">
            <code>src/app/core/services/push-notifications.service.ts</code>
        </p>




        <section data-compodoc="block-index">
            <h3 id="index">Index</h3>
            <table class="table table-sm table-bordered index-table">
                <tbody>
                    <tr>
                        <td class="col-md-4">
                            <h6><b>Properties</b></h6>
                        </td>
                    </tr>
                    <tr>
                        <td class="col-md-4">
                            <ul class="index-list">
                                <li>
                                        <a href="#badge" 
>
                                            badge
                                        </a>
                                </li>
                                <li>
                                        <a href="#categories" 
>
                                            categories
                                        </a>
                                </li>
                                <li>
                                        <a href="#enabled" 
>
                                            enabled
                                        </a>
                                </li>
                                <li>
                                        <a href="#priority" 
>
                                            priority
                                        </a>
                                </li>
                                <li>
                                        <a href="#quietHours" 
>
                                            quietHours
                                        </a>
                                </li>
                                <li>
                                        <a href="#sound" 
>
                                            sound
                                        </a>
                                </li>
                                <li>
                                        <a href="#vibration" 
>
                                            vibration
                                        </a>
                                </li>
                            </ul>
                        </td>
                    </tr>
                </tbody>
            </table>
        </section>



            <section data-compodoc="block-properties">
                <h3 id="inputs">Properties</h3>
                    <table class="table table-sm table-bordered">
                        <tbody>
                                <tr>
                                    <td class="col-md-4">
                                        <a name="badge"></a>
                                        <span class="name "><b>badge</b>
                                            <a href="#badge">
                                                <span class="icon ion-ios-link"></span>
                                            </a>
                                        </span>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="col-md-4">
                                        <code>badge:         <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/boolean" target="_blank" >boolean</a></code>
</code>
                                    </td>
                                </tr>


                                    <tr>
                                        <td class="col-md-4">
                                            <i>Type : </i>        <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/boolean" target="_blank" >boolean</a></code>

                                        </td>
                                    </tr>





                        </tbody>
                    </table>
                    <table class="table table-sm table-bordered">
                        <tbody>
                                <tr>
                                    <td class="col-md-4">
                                        <a name="categories"></a>
                                        <span class="name "><b>categories</b>
                                            <a href="#categories">
                                                <span class="icon ion-ios-link"></span>
                                            </a>
                                        </span>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="col-md-4">
                                        <code>categories:     <code>literal type</code>
</code>
                                    </td>
                                </tr>


                                    <tr>
                                        <td class="col-md-4">
                                            <i>Type : </i>    <code>literal type</code>

                                        </td>
                                    </tr>





                        </tbody>
                    </table>
                    <table class="table table-sm table-bordered">
                        <tbody>
                                <tr>
                                    <td class="col-md-4">
                                        <a name="enabled"></a>
                                        <span class="name "><b>enabled</b>
                                            <a href="#enabled">
                                                <span class="icon ion-ios-link"></span>
                                            </a>
                                        </span>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="col-md-4">
                                        <code>enabled:         <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/boolean" target="_blank" >boolean</a></code>
</code>
                                    </td>
                                </tr>


                                    <tr>
                                        <td class="col-md-4">
                                            <i>Type : </i>        <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/boolean" target="_blank" >boolean</a></code>

                                        </td>
                                    </tr>





                        </tbody>
                    </table>
                    <table class="table table-sm table-bordered">
                        <tbody>
                                <tr>
                                    <td class="col-md-4">
                                        <a name="priority"></a>
                                        <span class="name "><b>priority</b>
                                            <a href="#priority">
                                                <span class="icon ion-ios-link"></span>
                                            </a>
                                        </span>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="col-md-4">
                                        <code>priority:     <code>&quot;high&quot; | &quot;normal&quot; | &quot;low&quot;</code>
</code>
                                    </td>
                                </tr>


                                    <tr>
                                        <td class="col-md-4">
                                            <i>Type : </i>    <code>&quot;high&quot; | &quot;normal&quot; | &quot;low&quot;</code>

                                        </td>
                                    </tr>





                        </tbody>
                    </table>
                    <table class="table table-sm table-bordered">
                        <tbody>
                                <tr>
                                    <td class="col-md-4">
                                        <a name="quietHours"></a>
                                        <span class="name "><b>quietHours</b>
                                            <a href="#quietHours">
                                                <span class="icon ion-ios-link"></span>
                                            </a>
                                        </span>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="col-md-4">
                                        <code>quietHours:     <code>literal type</code>
</code>
                                    </td>
                                </tr>


                                    <tr>
                                        <td class="col-md-4">
                                            <i>Type : </i>    <code>literal type</code>

                                        </td>
                                    </tr>





                        </tbody>
                    </table>
                    <table class="table table-sm table-bordered">
                        <tbody>
                                <tr>
                                    <td class="col-md-4">
                                        <a name="sound"></a>
                                        <span class="name "><b>sound</b>
                                            <a href="#sound">
                                                <span class="icon ion-ios-link"></span>
                                            </a>
                                        </span>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="col-md-4">
                                        <code>sound:         <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/boolean" target="_blank" >boolean</a></code>
</code>
                                    </td>
                                </tr>


                                    <tr>
                                        <td class="col-md-4">
                                            <i>Type : </i>        <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/boolean" target="_blank" >boolean</a></code>

                                        </td>
                                    </tr>





                        </tbody>
                    </table>
                    <table class="table table-sm table-bordered">
                        <tbody>
                                <tr>
                                    <td class="col-md-4">
                                        <a name="vibration"></a>
                                        <span class="name "><b>vibration</b>
                                            <a href="#vibration">
                                                <span class="icon ion-ios-link"></span>
                                            </a>
                                        </span>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="col-md-4">
                                        <code>vibration:         <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/boolean" target="_blank" >boolean</a></code>
</code>
                                    </td>
                                </tr>


                                    <tr>
                                        <td class="col-md-4">
                                            <i>Type : </i>        <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/boolean" target="_blank" >boolean</a></code>

                                        </td>
                                    </tr>





                        </tbody>
                    </table>
            </section>
    </div>


    <div class="tab-pane fade  tab-source-code" id="source">
        <pre class="line-numbers compodoc-sourcecode"><code class="language-typescript">import { Injectable, signal, computed } from &#x27;@angular/core&#x27;;
import { Observable } from &#x27;rxjs&#x27;;
import { NativeBridgeService } from &#x27;./native-bridge.service&#x27;;

export interface PushNotification {
  id: string;
  title: string;
  body: string;
  data?: { [key: string]: any };
  badge?: number;
  sound?: string;
  vibrate?: number[];
  priority?: &#x27;high&#x27; | &#x27;normal&#x27; | &#x27;low&#x27;;
  channelId?: string;
  timestamp: Date;
  read: boolean;
  actionUrl?: string;
  category?: string;
  imageUrl?: string;
  iconUrl?: string;
}

export interface NotificationPermission {
  granted: boolean;
  denied: boolean;
  prompt: boolean;
  error?: string;
}

export interface NotificationSettings {
  enabled: boolean;
  sound: boolean;
  vibration: boolean;
  badge: boolean;
  categories: {
    [category: string]: boolean;
  };
  quietHours: {
    enabled: boolean;
    start: string; // HH:mm format
    end: string; // HH:mm format
    days: number[]; // 0-6 (Sunday-Saturday)
  };
  priority: &#x27;high&#x27; | &#x27;normal&#x27; | &#x27;low&#x27;;
}

export interface NotificationChannel {
  id: string;
  name: string;
  description: string;
  importance: &#x27;high&#x27; | &#x27;normal&#x27; | &#x27;low&#x27; | &#x27;min&#x27;;
  sound: boolean;
  vibration: boolean;
  lights: boolean;
  enabled: boolean;
}

@Injectable({
  providedIn: &#x27;root&#x27;
})
export class PushNotificationsService {
  private notificationsMap: Map&lt;string, PushNotification&gt; &#x3D; new Map();
  private settingsData: NotificationSettings &#x3D; this.getDefaultSettings();
  private channels: Map&lt;string, NotificationChannel&gt; &#x3D; new Map();
  private permissionData: NotificationPermission &#x3D; {
    granted: false,
    denied: false,
    prompt: false
  };

  // ✅ Signals for reactive state
  private _notifications &#x3D; signal&lt;PushNotification[]&gt;([]);
  private _settings &#x3D; signal&lt;NotificationSettings&gt;(this.settingsData);
  private _permission &#x3D; signal&lt;NotificationPermission&gt;(this.permissionData);
  private _unreadCount &#x3D; signal&lt;number&gt;(0);

  // ✅ Readonly signals for public access
  public readonly notifications &#x3D; this._notifications.asReadonly();
  public readonly settings &#x3D; this._settings.asReadonly();
  public readonly permission &#x3D; this._permission.asReadonly();
  public readonly unreadCount &#x3D; this._unreadCount.asReadonly();

  // ✅ Computed signals for derived state
  public readonly notificationsCount &#x3D; computed(() &#x3D;&gt; this._notifications().length);
  public readonly readNotificationsCount &#x3D; computed(() &#x3D;&gt; this._notifications().filter(n &#x3D;&gt; n.read).length);

  // ✅ Observable compatibility layer (for backward compatibility)
  public notifications$ &#x3D; new Observable&lt;PushNotification[]&gt;(observer &#x3D;&gt; {
    observer.next(this._notifications());
    // Note: This is a compatibility layer - prefer using signals directly
  });
  public settings$ &#x3D; new Observable&lt;NotificationSettings&gt;(observer &#x3D;&gt; {
    observer.next(this._settings());
    // Note: This is a compatibility layer - prefer using signals directly
  });
  public permission$ &#x3D; new Observable&lt;NotificationPermission&gt;(observer &#x3D;&gt; {
    observer.next(this._permission());
    // Note: This is a compatibility layer - prefer using signals directly
  });
  public unreadCount$ &#x3D; new Observable&lt;number&gt;(observer &#x3D;&gt; {
    observer.next(this._unreadCount());
    // Note: This is a compatibility layer - prefer using signals directly
  });

  constructor(
    private nativeBridge: NativeBridgeService
  ) {
    this.initializeNotificationChannels();
    this.checkPermission();
  }

  /**
   * Initialize default notification channels
   */
  private initializeNotificationChannels(): void {
    const defaultChannels: NotificationChannel[] &#x3D; [
      {
        id: &#x27;general&#x27;,
        name: &#x27;General Notifications&#x27;,
        description: &#x27;General app notifications&#x27;,
        importance: &#x27;normal&#x27;,
        sound: true,
        vibration: true,
        lights: true,
        enabled: true
      },
      {
        id: &#x27;attendance&#x27;,
        name: &#x27;Attendance Notifications&#x27;,
        description: &#x27;Time and attendance related notifications&#x27;,
        importance: &#x27;high&#x27;,
        sound: true,
        vibration: true,
        lights: true,
        enabled: true
      },
      {
        id: &#x27;security&#x27;,
        name: &#x27;Security Alerts&#x27;,
        description: &#x27;Security and safety alerts&#x27;,
        importance: &#x27;high&#x27;,
        sound: true,
        vibration: true,
        lights: true,
        enabled: true
      },
      {
        id: &#x27;approval&#x27;,
        name: &#x27;Approval Requests&#x27;,
        description: &#x27;Approval and workflow notifications&#x27;,
        importance: &#x27;normal&#x27;,
        sound: true,
        vibration: false,
        lights: true,
        enabled: true
      },
      {
        id: &#x27;system&#x27;,
        name: &#x27;System Notifications&#x27;,
        description: &#x27;System updates and maintenance&#x27;,
        importance: &#x27;low&#x27;,
        sound: false,
        vibration: false,
        lights: false,
        enabled: true
      }
    ];

    defaultChannels.forEach(channel &#x3D;&gt; {
      this.channels.set(channel.id, channel);
    });
  }

  /**
   * Get default settings
   */
  private getDefaultSettings(): NotificationSettings {
    return {
      enabled: true,
      sound: true,
      vibration: true,
      badge: true,
      categories: {
        general: true,
        attendance: true,
        security: true,
        approval: true,
        system: false
      },
      quietHours: {
        enabled: false,
        start: &#x27;22:00&#x27;,
        end: &#x27;08:00&#x27;,
        days: [0, 1, 2, 3, 4, 5, 6] // All days
      },
      priority: &#x27;normal&#x27;
    };
  }

  /**
   * Check notification permission
   */
  private async checkPermission(): Promise&lt;void&gt; {
    try {
      if (this.nativeBridge.isNative()) {
        const granted &#x3D; await this.nativeBridge.requestNotificationPermission();
        this.permissionData &#x3D; {
          granted,
          denied: !granted,
          prompt: false
        };
      } else {
        // Web fallback
        if (&#x27;Notification&#x27; in window) {
          this.permissionData &#x3D; {
            granted: Notification.permission &#x3D;&#x3D;&#x3D; &#x27;granted&#x27;,
            denied: Notification.permission &#x3D;&#x3D;&#x3D; &#x27;denied&#x27;,
            prompt: Notification.permission &#x3D;&#x3D;&#x3D; &#x27;default&#x27;
          };
        } else {
          this.permissionData &#x3D; {
            granted: false,
            denied: true,
            prompt: false,
            error: &#x27;Notifications not supported&#x27;
          };
        }
      }

      this._permission.set(this.permissionData);
    } catch (error) {
      this.permissionData &#x3D; {
        granted: false,
        denied: true,
        prompt: false,
        error: (error as Error).message
      };
      this._permission.set(this.permissionData);
    }
  }

  /**
   * Request notification permission
   */
  public async requestPermission(): Promise&lt;boolean&gt; {
    try {
      if (this.nativeBridge.isNative()) {
        const granted &#x3D; await this.nativeBridge.requestNotificationPermission();
        this.permissionData &#x3D; {
          granted,
          denied: !granted,
          prompt: false
        };
      } else {
        // Web fallback
        if (&#x27;Notification&#x27; in window) {
          const permission &#x3D; await Notification.requestPermission();
          this.permissionData &#x3D; {
            granted: permission &#x3D;&#x3D;&#x3D; &#x27;granted&#x27;,
            denied: permission &#x3D;&#x3D;&#x3D; &#x27;denied&#x27;,
            prompt: false
          };
        } else {
          throw new Error(&#x27;Notifications not supported&#x27;);
        }
      }

      this._permission.set(this.permissionData);
      return this.permissionData.granted;
    } catch (error) {
      this.permissionData &#x3D; {
        granted: false,
        denied: true,
        prompt: false,
        error: (error as Error).message
      };
      this._permission.set(this.permissionData);
      return false;
    }
  }

  /**
   * Send push notification
   */
  public async sendNotification(notification: Omit&lt;PushNotification, &#x27;id&#x27; | &#x27;timestamp&#x27; | &#x27;read&#x27;&gt;): Promise&lt;string&gt; {
    try {
      if (!this.permissionData.granted) {
        throw new Error(&#x27;Notification permission not granted&#x27;);
      }

      if (!this.settingsData.enabled) {
        throw new Error(&#x27;Notifications are disabled&#x27;);
      }

      // Check quiet hours
      if (this.isInQuietHours()) {
        // Notification suppressed due to quiet hours
        return &#x27;&#x27;;
      }

      // Check category settings
      if (notification.category &amp;&amp; !this.settingsData.categories[notification.category]) {
        // Notification suppressed for category
        return &#x27;&#x27;;
      }

      const id &#x3D; this.generateId();
      const fullNotification: PushNotification &#x3D; {
        ...notification,
        id,
        timestamp: new Date(),
        read: false
      };

      // Store notification
      this.notificationsMap.set(id, fullNotification);
      this._notifications.set(Array.from(this.notificationsMap.values()));
      this.updateUnreadCount();

      // Send native notification
      if (this.nativeBridge.isNative()) {
        await this.nativeBridge.sendPushNotification({
          title: notification.title,
          body: notification.body,
          data: notification.data,
          badge: notification.badge,
          sound: notification.sound,
          vibrate: notification.vibrate,
          priority: notification.priority,
          channelId: notification.channelId
        });
      } else {
        // Web fallback
        await this.sendWebNotification(fullNotification);
      }

      return id;
    } catch (error) {
      console.error(&#x27;Failed to send notification:&#x27;, error);
      throw error;
    }
  }

  /**
   * Send web notification
   */
  private async sendWebNotification(notification: PushNotification): Promise&lt;void&gt; {
    if (&#x27;Notification&#x27; in window &amp;&amp; Notification.permission &#x3D;&#x3D;&#x3D; &#x27;granted&#x27;) {
      const webNotification &#x3D; new Notification(notification.title, {
        body: notification.body,
        icon: notification.iconUrl || &#x27;/assets/icons/icon-192x192.png&#x27;,
        badge: &#x27;/assets/icons/icon-72x72.png&#x27;,
        data: notification.data,
        tag: notification.category,
        requireInteraction: notification.priority &#x3D;&#x3D;&#x3D; &#x27;high&#x27;,
        silent: !this.settingsData.sound
      });

      // Handle click
      webNotification.onclick &#x3D; () &#x3D;&gt; {
        this.markAsRead(notification.id);
        if (notification.actionUrl) {
          window.open(notification.actionUrl, &#x27;_blank&#x27;);
        }
        webNotification.close();
      };

      // Auto close after 5 seconds
      setTimeout(() &#x3D;&gt; {
        webNotification.close();
      }, 5000);
    }
  }

  /**
   * Get all notifications
   */
  public getNotifications(): PushNotification[] {
    return Array.from(this.notificationsMap.values()).sort((a, b) &#x3D;&gt; b.timestamp.getTime() - a.timestamp.getTime());
  }

  /**
   * Get unread notifications
   */
  public getUnreadNotifications(): PushNotification[] {
    return this.getNotifications().filter(notification &#x3D;&gt; !notification.read);
  }

  /**
   * Mark notification as read
   */
  public markAsRead(id: string): void {
    const notification &#x3D; this.notificationsMap.get(id);
    if (notification &amp;&amp; !notification.read) {
      notification.read &#x3D; true;
      this.notificationsMap.set(id, notification);
      this._notifications.set(Array.from(this.notificationsMap.values()));
      this.updateUnreadCount();
    }
  }

  /**
   * Mark all notifications as read
   */
  public markAllAsRead(): void {
    this.notificationsMap.forEach(notification &#x3D;&gt; {
      notification.read &#x3D; true;
      this.notificationsMap.set(notification.id, notification);
    });
    this._notifications.set(Array.from(this.notificationsMap.values()));
    this.updateUnreadCount();
  }

  /**
   * Delete notification
   */
  public deleteNotification(id: string): void {
    this.notificationsMap.delete(id);
    this._notifications.set(Array.from(this.notificationsMap.values()));
    this.updateUnreadCount();
  }

  /**
   * Clear all notifications
   */
  public clearAllNotifications(): void {
    this.notificationsMap.clear();
    this._notifications.set([]);
    this.updateUnreadCount();
  }

  /**
   * Get notification by ID
   */
  public getNotification(id: string): PushNotification | undefined {
    return this.notificationsMap.get(id);
  }

  /**
   * Update notification settings
   */
  public updateSettings(settings: Partial&lt;NotificationSettings&gt;): void {
    this.settingsData &#x3D; { ...this.settingsData, ...settings };
    this._settings.set(this.settingsData);
  }

  /**
   * Get current settings
   */
  public getSettings(): NotificationSettings {
    return { ...this.settingsData };
  }

  /**
   * Get notification channels
   */
  public getChannels(): NotificationChannel[] {
    return Array.from(this.channels.values());
  }

  /**
   * Update channel settings
   */
  public updateChannel(id: string, updates: Partial&lt;NotificationChannel&gt;): void {
    const channel &#x3D; this.channels.get(id);
    if (channel) {
      const updatedChannel &#x3D; { ...channel, ...updates };
      this.channels.set(id, updatedChannel);
    }
  }

  /**
   * Check if in quiet hours
   */
  private isInQuietHours(): boolean {
    if (!this.settingsData.quietHours.enabled) {
      return false;
    }

    const now &#x3D; new Date();
    const currentTime &#x3D; now.toTimeString().slice(0, 5); // HH:mm format
    const currentDay &#x3D; now.getDay();

    // Check if current day is in quiet hours days
    if (!this.settingsData.quietHours.days.includes(currentDay)) {
      return false;
    }

    const startTime &#x3D; this.settingsData.quietHours.start;
    const endTime &#x3D; this.settingsData.quietHours.end;

    // Handle overnight quiet hours (e.g., 22:00 to 08:00)
    if (startTime &gt; endTime) {
      return currentTime &gt;&#x3D; startTime || currentTime &lt;&#x3D; endTime;
    } else {
      return currentTime &gt;&#x3D; startTime &amp;&amp; currentTime &lt;&#x3D; endTime;
    }
  }

  /**
   * Update unread count
   */
  private updateUnreadCount(): void {
    const unreadCount &#x3D; this.getUnreadNotifications().length;
    this._unreadCount.set(unreadCount);
  }

  /**
   * Get unread count
   */
  public getUnreadCount(): number {
    return this._unreadCount();
  }

  /**
   * Check if notifications are enabled
   */
  public isEnabled(): boolean {
    return this.settingsData.enabled &amp;&amp; this.permissionData.granted;
  }

  /**
   * Check if permission is granted
   */
  public hasPermission(): boolean {
    return this.permissionData.granted;
  }

  /**
   * Get permission status
   */
  public getPermission(): NotificationPermission {
    return { ...this.permissionData };
  }

  /**
   * Schedule notification
   */
  public async scheduleNotification(notification: Omit&lt;PushNotification, &#x27;id&#x27; | &#x27;timestamp&#x27; | &#x27;read&#x27;&gt;, delay: number): Promise&lt;string&gt; {
    return new Promise((resolve, reject) &#x3D;&gt; {
      setTimeout(async () &#x3D;&gt; {
        try {
          const id &#x3D; await this.sendNotification(notification);
          resolve(id);
        } catch (error) {
          reject(error);
        }
      }, delay);
    });
  }

  /**
   * Cancel scheduled notification
   */
  public cancelScheduledNotification(id: string): void {
    // In a real implementation, this would cancel the scheduled notification
    // Scheduled notification cancelled
  }

  /**
   * Generate unique ID
   */
  private generateId(): string {
    return &#x27;notif_&#x27; + Date.now() + &#x27;_&#x27; + Math.random().toString(36).substr(2, 9);
  }

  /**
   * Export notifications
   */
  public exportNotifications(): string {
    const data &#x3D; {
      notifications: Array.from(this.notificationsMap.values()),
      settings: this.settingsData,
      channels: Array.from(this.channels.values()),
      exportDate: new Date().toISOString()
    };
    return JSON.stringify(data, null, 2);
  }

  /**
   * Import notifications
   */
  public importNotifications(data: string): void {
    try {
      const imported &#x3D; JSON.parse(data);

      if (imported.notifications) {
        imported.notifications.forEach((notif: any) &#x3D;&gt; {
          notif.timestamp &#x3D; new Date(notif.timestamp);
          this.notificationsMap.set(notif.id, notif);
        });
        this._notifications.set(Array.from(this.notificationsMap.values()));
        this.updateUnreadCount();
      }

      if (imported.settings) {
        this.settingsData &#x3D; { ...this.settingsData, ...imported.settings };
        this._settings.set(this.settingsData);
      }

      if (imported.channels) {
        imported.channels.forEach((channel: any) &#x3D;&gt; {
          this.channels.set(channel.id, channel);
        });
      }
    } catch (error) {
      console.error(&#x27;Failed to import notifications:&#x27;, error);
      throw error;
    }
  }
}

</code></pre>
    </div>
</div>








                   </div><div class="search-results">
    <div class="has-results">
        <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
        <ul class="search-results-list"></ul>
    </div>
    <div class="no-results">
        <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
    </div>
</div>
</div>
               <!-- END CONTENT -->
           </div>
       </div>

          <label class="dark-mode-switch">
               <input type="checkbox">
               <span class="slider">
                    <svg class="slider-icon" viewBox="0 0 24 24" fill="none" height="20" stroke="#000" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" width="20" xmlns="http://www.w3.org/2000/svg">
                    <path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"></path>
                    </svg>
               </span>
          </label>

       <script>
            var COMPODOC_CURRENT_PAGE_DEPTH = 1;
            var COMPODOC_CURRENT_PAGE_CONTEXT = 'interface';
            var COMPODOC_CURRENT_PAGE_URL = 'NotificationSettings-1.html';
            var MAX_SEARCH_RESULTS = 15;
       </script>

       <script>
               $darkModeToggleSwitchers = document.querySelectorAll('.dark-mode-switch input');
               checkToggle(darkModeState);
               if ($darkModeToggleSwitchers.length > 0) {
                    for (var i = 0; i < $darkModeToggleSwitchers.length; i++) {
                         $darkModeToggleSwitchers[i].addEventListener('change', function (event) {
                              darkModeState = !darkModeState;
                              toggleDarkMode(darkModeState);
                         });
                    }
               }
          </script>

       <script src="../js/libs/custom-elements.min.js"></script>
       <script src="../js/libs/lit-html.js"></script>

       <script src="../js/menu-wc.js" defer></script>
       <script nomodule src="../js/menu-wc_es5.js" defer></script>

       <script src="../js/libs/bootstrap-native.js"></script>

       <script src="../js/libs/es6-shim.min.js"></script>
       <script src="../js/libs/EventDispatcher.js"></script>
       <script src="../js/libs/promise.min.js"></script>

       <script src="../js/compodoc.js"></script>

       <script src="../js/tabs.js"></script>
       <script src="../js/menu.js"></script>
       <script src="../js/libs/clipboard.min.js"></script>
       <script src="../js/libs/prism.js"></script>
       <script src="../js/sourceCode.js"></script>
          <script src="../js/search/search.js"></script>
          <script src="../js/search/lunr.min.js"></script>
          <script src="../js/search/search-lunr.js"></script>
          <script src="../js/search/search_index.js"></script>
       <script src="../js/lazy-load-graphs.js"></script>


    </body>
</html>
