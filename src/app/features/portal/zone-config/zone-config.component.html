<div class="h-full flex flex-col p-6 space-y-6">
  <!-- Header -->
  <div class="flex justify-between items-center">
    <div>
      <h1 class="text-3xl font-bold bg-clip-text text-transparent bg-gradient-to-r from-indigo-600 to-purple-600 dark:from-indigo-400 dark:to-purple-400">
        Zone Configuration
      </h1>
      <p class="text-gray-500 dark:text-gray-400 mt-1">Define restricted areas, counting zones, and detection boundaries</p>
    </div>
    
    <div class="flex items-center gap-4">
      <select [ngModel]="selectedCamera().id" 
              class="px-3 py-2 bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg focus:ring-2 focus:ring-indigo-500/20 outline-none text-sm text-gray-900 dark:text-gray-100">
          <option *ngFor="let cam of cameras" [value]="cam.id">{{ cam.name }}</option>
      </select>
      <app-glass-button (click)="clearAll()" variant="secondary" icon="delete">
        Clear All
      </app-glass-button>
    </div>
  </div>

  <div class="flex flex-col lg:flex-row gap-6 flex-1 overflow-hidden">
    <!-- Canvas Area -->
    <div class="flex-1 bg-black rounded-2xl overflow-hidden shadow-lg relative border border-gray-800" #imageContainer>
        <canvas #canvas 
                (click)="onCanvasClick($event)"
                (mousemove)="onCanvasMouseMove($event)"
                class="absolute inset-0 w-full h-full cursor-crosshair"></canvas>
        
        <!-- Drawing Controls Overlay -->
        <div class="absolute bottom-6 left-1/2 -translate-x-1/2 flex gap-2 bg-gray-900/80 backdrop-blur px-4 py-2 rounded-full border border-gray-700 shadow-xl">
            <button *ngIf="!isDrawing()" (click)="startDrawing()" 
                    class="px-4 py-2 bg-indigo-600 hover:bg-indigo-700 text-white rounded-full text-sm font-medium transition-colors flex items-center gap-2">
                <i class="fas fa-pen"></i> Draw Zone
            </button>
            
            <ng-container *ngIf="isDrawing()">
                <button (click)="finishDrawing()" class="px-4 py-2 bg-green-600 hover:bg-green-700 text-white rounded-full text-sm font-medium transition-colors">
                    <i class="fas fa-check"></i> Finish
                </button>
                <button (click)="cancelDrawing()" class="px-4 py-2 bg-gray-600 hover:bg-gray-700 text-white rounded-full text-sm font-medium transition-colors">
                    <i class="fas fa-times"></i> Cancel
                </button>
            </ng-container>
        </div>
    </div>

    <!-- Zone List -->
    <app-glass-card class="w-full lg:w-80 flex flex-col overflow-hidden">
        <div class="p-4 border-b border-gray-200 dark:border-gray-700">
            <h2 class="font-semibold text-gray-800 dark:text-gray-100">Configured Zones</h2>
        </div>
        <div class="flex-1 overflow-y-auto p-2 space-y-2 custom-scrollbar">
            <div *ngIf="zones().length === 0" class="text-center py-8 text-gray-500 text-sm">
                No zones defined. Click "Draw Zone" to start.
            </div>

            <div *ngFor="let zone of zones()" 
                 (click)="selectZone(zone.id)"
                 [class.border-indigo-500]="activeZoneId() === zone.id"
                 [class.bg-indigo-50]="activeZoneId() === zone.id"
                 [class.dark:bg-indigo-900/20]="activeZoneId() === zone.id"
                 class="p-3 rounded-lg bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 cursor-pointer transition-all hover:shadow-md group">
                <div class="flex justify-between items-start">
                    <div class="flex items-center gap-2">
                        <div class="w-3 h-3 rounded-full" [style.backgroundColor]="zone.color"></div>
                        <span class="font-medium text-gray-900 dark:text-gray-100 text-sm">{{ zone.name }}</span>
                    </div>
                    <button (click)="deleteZone(zone.id); $event.stopPropagation()" class="text-gray-400 hover:text-red-500 transition-colors">
                        <i class="fas fa-trash-alt text-xs"></i>
                    </button>
                </div>
                <div class="mt-2 text-xs text-gray-500 flex gap-2">
                    <span class="px-2 py-0.5 rounded bg-gray-100 dark:bg-gray-700 border border-gray-200 dark:border-gray-600 uppercase tracking-wide text-[10px]">
                        {{ zone.type }}
                    </span>
                    <span>{{ zone.points.length }} Points</span>
                </div>
            </div>
        </div>
    </app-glass-card>
  </div>
</div>

